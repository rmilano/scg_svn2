<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Asunto">

    <resultMap id="asuntoDetalleMap" class="mx.gob.economia.scg.model.Asunto">
        <result property="id_asunto" column="id_asunto"/>
        <result property="asunto" column="asunto"/>
        <result property="folio" column="folio"/>
        <result property="contador_folio" column="contador_folio"/>
        <result property="descripcion" column="descripcion"/>
        <result property="no_oficio" column="no_oficio"/>
        <result property="fh_oficio" column="fh_oficio"/>
        <result property="fh_recepcion" column="fh_recepcion"/>
        <result property="fh_por_vencer" column="fh_por_vencer"/>
        <result property="estatus" column="estatus"/>
        <result property="empleado_capt.id_empleado" column="id_empleado_capt"/>
        <result property="empleado_capt.correo" column="correo_capt"/>
        <result property="empleado_capt.nombre" column="nombre_capt"/>
        <result property="empleado_capt.paterno" column="paterno_capt"/>
        <result property="empleado_capt.materno" column="materno_capt"/>
        <result property="empleado_capt.area.id_area" column="id_area_capt"/>
        <result property="empleado_capt.area.area" column="area_capt"/>
        <result property="empleado_capt.puesto" column="puesto_capt"/>
        <result property="empleado_capt.activo" column="activo_capt"/>
        <result property="asunto_detalle.id_asunto_detalle" column="id_asunto_detalle"/>
        <result property="asunto_detalle.estatus" column="estatus"/>
        <result property="asunto_detalle.fh_lectura" column="fh_lectura"/>
        <result property="asunto_detalle.fh_registro" column="fh_registro"/>
        <result property="asunto_detalle.fh_limite" column="fh_limite"/>
        <result property="asunto_detalle.comentario" column="comentario"/>
        <result property="asunto_detalle.ip" column="ip"/>
        <result property="asunto_detalle.empleado_remi.id_empleado" column="id_empleado_remi"/>
        <result property="asunto_detalle.empleado_remi.correo" column="correo_remi"/>
        <result property="asunto_detalle.empleado_remi.nombre" column="nombre_remi"/>
        <result property="asunto_detalle.empleado_remi.paterno" column="paterno_remi"/>
        <result property="asunto_detalle.empleado_remi.materno" column="materno_remi"/>
        <result property="asunto_detalle.empleado_remi.id_area" column="id_area_remi"/>
        <result property="asunto_detalle.empleado_remi.area.id_area" column="id_area_remi"/>
        <result property="asunto_detalle.empleado_remi.area.area" column="area_remi"/>
        <result property="asunto_detalle.empleado_remi.puesto" column="puesto_remi"/>
        <result property="asunto_detalle.empleado_remi.activo" column="activo_remi"/>
        <result property="asunto_detalle.empleado_dest.id_empleado" column="id_empleado_dest"/>
        <result property="asunto_detalle.empleado_dest.correo" column="correo_dest"/>
        <result property="asunto_detalle.empleado_dest.nombre" column="nombre_dest"/>
        <result property="asunto_detalle.empleado_dest.paterno" column="paterno_dest"/>
        <result property="asunto_detalle.empleado_dest.materno" column="materno_dest"/>
        <result property="asunto_detalle.empleado_dest.id_area" column="id_area_dest"/>
        <result property="asunto_detalle.empleado_dest.area.id_area" column="id_area_dest"/>
        <result property="asunto_detalle.empleado_dest.area.area" column="area_dest"/>
        <result property="asunto_detalle.empleado_dest.puesto" column="puesto_dest"/>
        <result property="asunto_detalle.empleado_dest.activo" column="activo_dest"/>
        <result property="asunto_detalle.empleado_dest_ini.id_empleado" column="id_empleado_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.correo" column="correo_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.nombre" column="nombre_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.paterno" column="paterno_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.materno" column="materno_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.id_area" column="id_area_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.area.id_area" column="id_area_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.area.area" column="area_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.puesto" column="puesto_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.activo" column="activo_ini"/>
        <result property="asunto_detalle.prioridad.id_prioridad" column="id_prioridad"/>
        <result property="id_asunto_padre" column="id_asunto_padre"/>
        <result property="id_expediente" column="id_expediente"/>
        <result property="expediente.expediente" column="expediente"/>
        <result property="expediente.id_expediente" column="id_expediente"/>
        <result property="id_tema" column="id_tema"/>
        <result property="tema.tema" column="tema"/>
        <result property="tema.evento" column="tema_evento"/>
        <result property="fh_evento" column="fh_evento"/>
        <result property="tema.id_tema" column="id_tema"/>
        <result property="tema.id_tema_padre" column="id_tema_padre"/>
        <result property="id_instruccion" column="id_instruccion"/>
        <result property="instruccion.id_instruccion" column="id_instruccion"/>
        <result property="instruccion.instruccion" column="instruccion"/>
        <result property="tipoAsunto.id_tipo_documento" column="id_tipo_asunto"/>
        <result property="confidencial" column="confidencial"/>
        <result property="atencionParcial" column="atencionParcial"/>
    </resultMap>


    <resultMap id="asuntoDetalleVolanteMap" class="mx.gob.economia.scg.model.Asunto">
        <result property="id_asunto" column="id_asunto"/>
        <result property="id_asunto_ref" column="id_asunto_ref"/>
        <result property="asunto" column="asunto"/>
        <result property="folio" column="folio"/>
        <result property="descripcion" column="descripcion"/>
        <result property="no_oficio" column="no_oficio"/>
        <result property="fh_oficio" column="fh_oficio"/>
        <result property="fh_recepcion" column="fh_recepcion"/>
        <result property="fh_por_vencer" column="fh_por_vencer"/>
        <result property="estatus" column="estatus"/>
        <result property="empleado_capt.id_empleado" column="id_empleado_capt"/>
        <result property="empleado_capt.correo" column="correo_capt"/>
        <result property="empleado_capt.nombre" column="nombre_capt"/>
        <result property="empleado_capt.paterno" column="paterno_capt"/>
        <result property="empleado_capt.materno" column="materno_capt"/>
        <result property="empleado_capt.area.id_area" column="id_area_capt"/>
        <result property="empleado_capt.area.area" column="area_capt"/>
        <result property="empleado_capt.puesto" column="puesto_capt"/>
        <result property="empleado_capt.activo" column="activo_capt"/>
        <result property="asunto_detalle.id_asunto_detalle" column="id_asunto_detalle"/>
        <result property="asunto_detalle.estatus" column="estatus"/>
        <result property="asunto_detalle.fh_lectura" column="fh_lectura"/>
        <result property="asunto_detalle.fh_registro" column="fh_registro"/>
        <result property="asunto_detalle.fh_limite" column="fh_limite"/>
        <result property="asunto_detalle.comentario" column="comentario"/>
        <result property="asunto_detalle.ip" column="ip"/>
        <result property="asunto_detalle.empleado_remi.id_empleado" column="id_empleado_remi"/>
        <result property="asunto_detalle.empleado_remi.correo" column="correo_remi"/>
        <result property="asunto_detalle.empleado_remi.nombre" column="nombre_remi"/>
        <result property="asunto_detalle.empleado_remi.paterno" column="paterno_remi"/>
        <result property="asunto_detalle.empleado_remi.materno" column="materno_remi"/>
        <result property="asunto_detalle.empleado_remi.id_area" column="id_area_remi"/>
        <result property="asunto_detalle.empleado_remi.area.id_area" column="id_area_remi"/>
        <result property="asunto_detalle.empleado_remi.area.area" column="area_remi"/>
        <result property="asunto_detalle.empleado_remi.puesto" column="puesto_remi"/>
        <result property="asunto_detalle.empleado_remi.activo" column="activo_remi"/>
        <result property="asunto_detalle.empleado_dest.id_empleado" column="id_empleado_dest"/>
        <result property="asunto_detalle.empleado_dest.correo" column="correo_dest"/>
        <result property="asunto_detalle.empleado_dest.nombre" column="nombre_dest"/>
        <result property="asunto_detalle.empleado_dest.paterno" column="paterno_dest"/>
        <result property="asunto_detalle.empleado_dest.materno" column="materno_dest"/>
        <result property="asunto_detalle.empleado_dest.id_area" column="id_area_dest"/>
        <result property="asunto_detalle.empleado_dest.area.id_area" column="id_area_dest"/>
        <result property="asunto_detalle.empleado_dest.area.area" column="area_dest"/>
        <result property="asunto_detalle.empleado_dest.puesto" column="puesto_dest"/>
        <result property="asunto_detalle.empleado_dest.activo" column="activo_dest"/>
        <result property="asunto_detalle.empleado_dest_ini.id_empleado" column="id_empleado_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.correo" column="correo_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.nombre" column="nombre_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.paterno" column="paterno_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.materno" column="materno_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.id_area" column="id_area_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.area.id_area" column="id_area_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.area.area" column="area_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.puesto" column="puesto_ini"/>
        <result property="asunto_detalle.empleado_dest_ini.activo" column="activo_ini"/>
        <result property="asunto_detalle.prioridad.id_prioridad" column="id_prioridad"/>
        <result property="id_asunto_padre" column="id_asunto_padre"/>
        <result property="id_expediente" column="id_expediente"/>
        <result property="expediente.expediente" column="expediente"/>
        <result property="expediente.id_expediente" column="id_expediente"/>
        <result property="id_tema" column="id_tema"/>
        <result property="tema.tema" column="tema"/>
        <result property="tema.evento" column="tema_evento"/>
        <result property="evento.evento" column="evento"/>
        <result property="fh_evento" column="fh_evento"/>
        <result property="tema.id_tema" column="id_tema"/>
        <result property="tema.id_tema_padre" column="id_tema_padre"/>
        <result property="instruccion.id_instruccion" column="id_instruccion"/>
        <result property="instruccion.instruccion" column="instruccion"/>
        <result property="empleado_revi.id_empleado" column="id_empleado_revi"/>
        <result property="tipoAsunto.id_tipo_documento" column="id_tipo_asunto"/>
        <result property="atencionParcial" column="atencionParcial"/>
    </resultMap>


    <resultMap id="asuntoMap" class="mx.gob.economia.scg.model.Asunto">
        <result property="id_asunto" column="id_asunto"/>
        <result property="id_asunto_ref" column="id_asunto_ref"/>
        <result property="folio" column="folio"/>
        <result property="asunto" column="asunto"/>
        <result property="descripcion" column="descripcion"/>        
        <result property="no_oficio" column="no_oficio"/>
        <result property="fh_oficio" column="fh_oficio"/>
        <result property="fh_recepcion" column="fh_recepcion"/>
        <result property="estatus" column="estatus"/>
        <result property="empleado_capt.id_empleado" column="id_empleado_capt"/>
        <result property="empleado_capt.correo" column="correo_capt"/>
        <result property="empleado_capt.nombre" column="nombre_capt"/>
        <result property="empleado_capt.paterno" column="paterno_capt"/>
        <result property="empleado_capt.materno" column="materno_capt"/>
        <result property="empleado_capt.area.id_area" column="id_area_capt"/>
        <result property="empleado_capt.area.area" column="area_capt"/>
        <result property="empleado_capt.puesto" column="puesto_capt"/>
        <result property="empleado_capt.activo" column="activo_capt"/>
        <result property="id_asunto_padre" column="id_asunto_padre"/>
        <result property="id_expediente" column="id_expediente"/>
        <result property="expediente.expediente" column="expediente"/>
        <result property="expediente.cve_expediente" column="cve_expediente"/>
        <result property="expediente.id_expediente" column="id_expediente"/>
        <result property="id_tema" column="id_tema"/>
        <result property="id_evento" column="id_evento"/>
        <result property="evento.id_evento" column="id_evento"/>
        <result property="tema.tema" column="tema"/>
        <result property="tema.id_tema" column="id_tema"/>
        <result property="tema.id_tema_padre" column="id_tema_padre"/>
        <result property="tema.evento" column="tema_evento"/>
        <result property="evento.evento" column="evento"/>
        <result property="fh_evento" column="fh_evento"/>
        <result property="id_instruccion" column="id_instruccion"/>
        <result property="instruccion.instruccion" column="instruccion"/>
        <result property="instruccion.id_instruccion" column="id_instruccion"/>
        <result property="tipoAsunto.id_tipo_documento" column="id_tipo_asunto"/>
        <result property="confidencial" column="confidencial"/>
        <result property="antecedente" column="antecedente"/>
    </resultMap>


    <resultMap id="asuntoCompletoMap" class="mx.gob.economia.scg.model.Asunto" extends="asuntoMap">
        <result property="asuntos_detalles" column="id_asunto" select="AsuntoDetalle.listByIdAsuntoDetalle"/>
        <result property="empleadosCcp" column="id_asunto" select="Empleado.listCcpByIdAsunto"/>
        <result property="asuntoAtencionParcial" column="id_asunto" select="AsuntoDetalle.asuntoAtencionParcial"/>
        <result property="atencionParcial" column="atencionParcial"/>
    </resultMap>


    <resultMap id="asuntoReporteVolanteMap" class="mx.gob.economia.scg.model.Asunto">
        <result property="id_asunto" column="id_asunto"/>
        <result property="id_asunto_ref" column="id_asunto_ref"/>
        <result property="asunto" column="asunto"/>
        <result property="descripcion" column="descripcion"/>
        <result property="no_oficio" column="no_oficio"/>
        <result property="fh_oficio" column="fh_oficio"/>
        <result property="estatus" column="estatus"/>
        <result property="asunto_detalle.fh_limite" column="fh_limite"/>
        <result property="asunto_detalle.empleado_remi.nombre" column="remitente_nombre"/>
        <result property="asunto_detalle.empleado_remi.paterno" column="remitente_paterno"/>
        <result property="asunto_detalle.empleado_remi.materno" column="remitente_materno"/>
        <result property="asunto_detalle.empleado_dest.nombre" column="destinatario_nombre"/>
        <result property="asunto_detalle.empleado_dest.paterno" column="destinatario_paterno"/>
        <result property="asunto_detalle.empleado_dest.materno" column="destinatario_materno"/>
        <result property="expediente.expediente" column="expediente"/>
        <result property="tema.tema" column="tema"/>
        <result property="tipoAsunto.id_tipo_documento" column="id_tipo_asunto"/>
    </resultMap>

    <select id="getByIdAsunto" resultMap="asuntoCompletoMap" parameterClass="java.lang.Integer">
		SELECT
		    a.id_asunto, a.id_asunto_ref,a.folio, 
                    a.folio || '-' || a.contador_folio contador_folio,
                    a.asunto, a.descripcion,
                    a.no_oficio, a.fh_oficio, a.fh_recepcion, a.id_empleado_capt,
		    (SELECT ad2.estatus FROM asunto_detalle ad2 WHERE ad2.id_asunto_detalle =
		    (SELECT MAX(ad3.id_asunto_detalle) FROM asunto_detalle ad3 WHERE ad3.id_asunto = a.id_asunto)) estatus,
		    c.correo AS correo_capt, c.nombre AS nombre_capt,
		    c.paterno AS paterno_capt, c.materno AS materno_capt,
		    c.id_area AS id_area_capt, ac.area AS area_capt, c.activo AS activo_capt, c.puesto AS puesto_capt, a.id_asunto_padre,
		    a.id_expediente, e.expediente, e.cve_expediente, a.id_tema, t.id_tema_padre, t.tema, t.evento tema_evento, ev.evento, a.fh_evento, a.id_instruccion,
                    i.instruccion, a.id_tipo_asunto, a.confidencial, a.antecedente, a.id_evento,
                    (select count(*) from asunto_atencion_parcial aap where aap.id_asunto = a.id_asunto) atencionParcial
		FROM asunto a
		LEFT JOIN empleado c ON c.id_empleado = a.id_empleado_capt
		LEFT JOIN area ac ON ac.id_area = c.id_area
		LEFT JOIN expediente e ON e.id_expediente = a.id_expediente
		LEFT JOIN tema t ON t.id_tema = a.id_tema
                LEFT JOIN evento ev ON ev.id_evento = a.id_evento
        LEFT JOIN instruccion i ON i.id_instruccion = a.id_instruccion
		WHERE a.id_asunto = #id_asunto#
    </select>

    <select id="getBitacoraAsunto" resultClass="mx.gob.economia.scg.model.BitacoraAsunto" parameterClass="java.lang.Integer">
		SELECT bitacora1, bitacora2
                FROM bitacora_asunto
		WHERE id_asunto = #id_asunto#
    </select>

    <insert id="insertBitacoraAsunto" parameterClass="mx.gob.economia.scg.model.BitacoraAsunto">
		INSERT INTO bitacora_asunto(id_asunto, bitacora1, bitacora2)
		VALUES (#id_asunto#, upper(#bitacora1#), upper(#bitacora2#))
    </insert>

    <update id="updateBitacoraAsunto" parameterClass="mx.gob.economia.scg.model.BitacoraAsunto">
		UPDATE bitacora_asunto
                SET bitacora1=#bitacora1#,
		    bitacora2=#bitacora2#
		WHERE id_asunto=#id_asunto#
    </update>

    <delete id="deleteBitacoraAsunto" parameterClass="java.lang.Integer">
		DELETE FROM bitacora_asunto WHERE id_asunto = #id_asunto#
    </delete>

    <select id="getDetalleByIdAsunto" parameterClass="java.lang.Integer" resultMap="asuntoDetalleVolanteMap">

                SELECT a.id_asunto_ref, a.id_instruccion,ins.instruccion,a.id_empleado_revi,
	            a.id_asunto, a.asunto, a.descripcion, a.no_oficio, a.fh_oficio, a.fh_recepcion, a.id_empleado_capt, a.folio,
	            CASE to_number(to_char(ad.fh_limite-2,'d'))
	            WHEN 7 THEN ad.fh_limite-4
	            WHEN 6 THEN ad.fh_limite-4
	            ELSE ad.fh_limite-2 END AS fh_por_vencer, ad.estatus, ad.id_prioridad,
	            c.correo AS correo_capt, c.nombre AS nombre_capt,
	            c.paterno AS paterno_capt, c.materno AS materno_capt,
	            c.id_area AS id_area_capt, ac.area AS area_capt, c.activo AS activo_capt, c.puesto AS puesto_capt,
	            ad.id_asunto_detalle, ad.fh_lectura, ad.fh_registro, ad.fh_limite, ad.comentario, ad.ip,
	            r.id_empleado AS id_empleado_remi, r.correo AS correo_remi, r.nombre AS nombre_remi,
	            r.paterno AS paterno_remi, r.materno AS materno_remi,
	            r.id_area AS id_area_remi, ar_r.area AS area_remi, r.activo AS activo_remi, r.puesto AS puesto_remi,
	            d.id_empleado AS id_empleado_dest, d.correo AS correo_dest, d.nombre AS nombre_dest,
	            d.paterno AS paterno_dest, d.materno AS materno_dest,
	            d.id_area AS id_area_dest, ar_d.area AS area_dest, d.activo AS activo_dest, d.puesto AS puesto_dest,
	            i.id_empleado AS id_empleado_ini, i.correo AS correo_ini, i.nombre AS nombre_ini,
	            i.paterno AS paterno_ini, i.materno AS materno_ini,
	            i.id_area AS id_area_ini, ar_i.area AS area_ini, i.activo AS activo_ini, i.puesto AS puesto_ini, a.id_asunto_padre,
	            a.id_expediente, e.expediente, a.id_tema, t.id_tema_padre, t.tema, t.evento tema_evento, ev.evento, a.fh_evento, a.id_tipo_asunto, antecedente,
                    (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) atencionParcial
	        FROM asunto a
	        LEFT JOIN empleado c ON c.id_empleado = a.id_empleado_capt
	        LEFT JOIN area ac ON ac.id_area = c.id_area
	        LEFT JOIN asunto_detalle ad ON a.id_asunto = ad.id_asunto
	        LEFT JOIN empleado d ON d.id_empleado = ad.id_empleado_dest
	        LEFT JOIN area ar_d ON ar_d.id_area = d.id_area
	        LEFT JOIN empleado r ON r.id_empleado = ad.id_empleado_remi
	        LEFT JOIN area ar_r ON ar_r.id_area = r.id_area
	        LEFT JOIN empleado i ON i.id_empleado = ad.id_empleado_ini
	        LEFT JOIN area ar_i ON ar_i.id_area = i.id_area
	        LEFT JOIN expediente e ON e.id_expediente = a.id_expediente
                LEFT JOIN instruccion ins ON ins.id_instruccion = a.id_instruccion
		LEFT JOIN tema t ON t.id_tema = a.id_tema
                LEFT JOIN evento ev ON ev.id_evento = a.id_evento
                WHERE a.id_asunto =#id_asunto#
                ORDER BY a.id_asunto DESC, ad.id_asunto_detalle ASC
    </select>
    <select id="listEmpleadoCcpByIdAsunto" parameterClass="java.lang.Integer" resultClass="mx.gob.economia.scg.model.Empleado">
		SELECT
			e.id_empleado, e.nombre, e.paterno, e.materno, e.puesto
		FROM asunto_ccp a LEFT JOIN empleado e ON e.id_empleado = a.id_empleado
		WHERE a.id_asunto = #id_asunto#
		ORDER BY e.nombre, e.paterno, e.materno
    </select>
    <select id="getFolioAsunto" resultClass="java.lang.String" parameterClass="java.lang.Integer">
        select clave ||'-'|| (SELECT TO_CHAR(TRUNC(SYSDATE, 'YEAR'), 'YYYY') year FROM dual)
        || '-'||
        (select case
        when (cast((SELECT TO_CHAR(TRUNC(SYSDATE, 'YEAR'), 'YYYY') year FROM dual) as integer)) >
        (select cast( to_char(TRUNC( max(marca_tiempo),'YEAR'), 'YYYY') as integer )from ASUNTO_CONSECUTIVO_AREA where id_area = #value#)
        then 1
        else
        (select NVL( max(consecutivo) + 1,'1') folio from  asunto_consecutivo_area where id_area=#value#
        and TO_CHAR(TRUNC(MARCA_TIEMPO, 'YEAR'), 'YYYY') = TO_CHAR(TRUNC(SYSDATE, 'YEAR'), 'YYYY') )
        END folio
        from dual)
        from AREA where id_area=#value#
    </select>
    <select id="getIdsAsuntoByCriterio" parameterClass="mx.gob.economia.scg.model.CriterioAsunto" resultClass="java.lang.String">
		SELECT id_asunto FROM asunto
        <dynamic prepend="WHERE">
            <isNotNull prepend="" property="folio">
                <isNotEqual prepend="AND" property="folio" compareValue="">
					folio =  #folio#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="AND" property="fh_oficio_ini">
				fh_oficio = #fh_oficio_ini#
            </isNotNull>
            <isNotNull prepend="AND" property="fh_recepcion_ini">
				fh_recepcion = #fh_recepcion_ini#
            </isNotNull>
            <isNotNull prepend="" property="id_asunto_ref">
                <isNotEqual prepend="AND" property="id_asunto_ref" compareValue="" >
                                        id_asunto_ref = '$id_asunto_ref$'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="no_oficio">
                <isNotEqual prepend="AND" property="no_oficio" compareValue="">
					no_oficio = #no_oficio#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="asunto">
                <isNotEqual prepend="AND" property="asunto" compareValue="">
					asunto LIKE '%$asunto$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="descripcion">
                <isNotEqual prepend="AND" property="descripcion" compareValue="">
					descripcion LIKE '%$descripcion$%'
                </isNotEqual>
            </isNotNull>
        </dynamic>
        AND ROWNUM <![CDATA[ <= ]]>#paginador.numMaxRegistros#
    </select>


    <select id="getLastIdsAsuntoByCriterio" parameterClass="mx.gob.economia.scg.model.CriterioAsunto" resultClass="java.lang.String">
    select id_asunto from (
    select max(asuntoup.ID_ASUNTO) id_asunto from asunto asuntoup
    where asuntoup.FOLIO in(
        select asunto.FOLIO from asunto
        inner join empleado captura on asunto.ID_EMPLEADO_CAPT = captura.ID_EMPLEADO
        <dynamic prepend="WHERE">
            <isNotNull prepend="" property="id_area_capt">
                <isNotEqual prepend="AND" property="id_area_capt" compareValue="">
			captura.ID_AREA = #id_area_capt#
                </isNotEqual>
            </isNotNull>
        </dynamic>
        group by asunto.FOLIO
        )  group by asuntoup.FOLIO
        ) WHERE ROWNUM <![CDATA[ <= ]]>#paginador.numMaxRegistros#
    </select>


    <select id="getIdsAsuntoCapturaByCriterio" parameterClass="mx.gob.economia.scg.model.CriterioAsunto" resultClass="java.lang.String">
		SELECT DISTINCT(ASUNTO.ID_ASUNTO) FROM ASUNTO
                INNER JOIN ASUNTO_DETALLE DETALLE ON ASUNTO.ID_ASUNTO = DETALLE.ID_ASUNTO
        <dynamic prepend="WHERE">
            <isNotNull prepend="" property="id_area_capt">
                <isNotEqual prepend="AND" property="id_area_capt" compareValue="">
			ASUNTO.id_empleado_capt in (select id_empleado from empleado where id_area in (select id_area from area connect by prior id_area = id_area_padre start with id_area = #id_area_capt#))
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="folio">
                <isNotEqual prepend="AND" property="folio" compareValue="">
			ASUNTO.folio like  '%$folio$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="AND" property="fh_oficio_ini">
				ASUNTO.fh_oficio = #fh_oficio_ini#
            </isNotNull>
            <isNotNull prepend="AND" property="fh_recepcion_ini">
				ASUNTO.fh_recepcion = #fh_recepcion_ini#
            </isNotNull>
            <isNotNull prepend="" property="id_asunto_ref">
                <isNotEqual prepend="AND" property="id_asunto_ref" compareValue="" >
                                        ASUNTO.id_asunto_ref like '%$id_asunto_ref$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="no_oficio">
                <isNotEqual prepend="AND" property="no_oficio" compareValue="">
					ASUNTO.no_oficio like '%$no_oficio$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="asunto">
                <isNotEqual prepend="AND" property="asunto" compareValue="">
					asunto LIKE '%$asunto$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="descripcion">
                <isNotEqual prepend="AND" property="descripcion" compareValue="">
					ASUNTO.descripcion LIKE '%$descripcion$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_tema">
                <isGreaterThan prepend="and" property="id_tema" compareValue="0">
                    ASUNTO.id_tema = #id_tema#
                </isGreaterThan>
            </isNotNull>
            <isNotNull prepend="" property="id_expediente">
                <isGreaterThan prepend="and" property="id_expediente" compareValue="0">
                    ASUNTO.id_expediente = #id_expediente#
                </isGreaterThan>
            </isNotNull>
            <isNotNull prepend="and" property="fh_evento">
                    ASUNTO.fh_evento = #fh_evento#
            </isNotNull>
            <isNotNull prepend="and" property="fh_registro">
                    DETALLE.FH_REGISTRO = #fh_registro#
                    AND DETALLE.ID_ASUNTO_DETALLE = (SELECT MIN(ID_ASUNTO_DETALLE) FROM ASUNTO_DETALLE INDETALLE WHERE INDETALLE.ID_ASUNTO_DETALLE = DETALLE.ID_ASUNTO_DETALLE)
            </isNotNull>
            AND ROWNUM<![CDATA[ <= 50 ]]>
        </dynamic>
    </select>
    <select id="listByCriterio" parameterClass="mx.gob.economia.scg.model.CriterioAsunto" resultMap="asuntoDetalleMap">
		SELECT * FROM (
		SELECT vista.*, rownum r FROM(
			SELECT a.folio, a.folio || '-' || a.contador_folio contador_folio,
	            a.id_asunto, a.asunto, a.descripcion, a.no_oficio, a.fh_oficio, a.fh_recepcion, a.id_empleado_capt,
	            CASE to_number(to_char(ad.fh_limite-2,'d'))
	            WHEN 7 THEN ad.fh_limite-4
	            WHEN 6 THEN ad.fh_limite-4
	            ELSE ad.fh_limite-2 END AS fh_por_vencer, ad.estatus,
	            c.correo AS correo_capt, c.nombre AS nombre_capt,
	            c.paterno AS paterno_capt, c.materno AS materno_capt,
	            c.id_area AS id_area_capt, ac.area AS area_capt, c.activo AS activo_capt, c.puesto AS puesto_capt,
	            ad.id_asunto_detalle, ad.fh_lectura, ad.fh_registro, ad.fh_limite, ad.comentario, ad.ip,
	            r.id_empleado AS id_empleado_remi, r.correo AS correo_remi, r.nombre AS nombre_remi,
	            r.paterno AS paterno_remi, r.materno AS materno_remi,
	            r.id_area AS id_area_remi, ar_r.area AS area_remi, r.activo AS activo_remi, r.puesto AS puesto_remi,
	            d.id_empleado AS id_empleado_dest, d.correo AS correo_dest, d.nombre AS nombre_dest,
	            d.paterno AS paterno_dest, d.materno AS materno_dest,
	            d.id_area AS id_area_dest, ar_d.area AS area_dest, d.activo AS activo_dest, d.puesto AS puesto_dest,
	            i.id_empleado AS id_empleado_ini, i.correo AS correo_ini, i.nombre AS nombre_ini,
	            i.paterno AS paterno_ini, i.materno AS materno_ini,
	            i.id_area AS id_area_ini, ar_i.area AS area_ini, i.activo AS activo_ini, i.puesto AS puesto_ini, a.id_asunto_padre,
	            a.id_expediente, e.expediente, a.id_tema, t.id_tema_padre, t.tema, t.evento tema_evento, a.fh_evento,
	            a.id_instruccion, ins.instruccion,a.id_tipo_asunto, ad.id_prioridad, a.confidencial
	        FROM asunto a
	        LEFT JOIN empleado c ON c.id_empleado = a.id_empleado_capt
	        LEFT JOIN area ac ON ac.id_area = c.id_area
	        LEFT JOIN asunto_detalle ad ON a.id_asunto = ad.id_asunto
	        LEFT JOIN empleado d ON d.id_empleado = ad.id_empleado_dest
	        LEFT JOIN area ar_d ON ar_d.id_area = d.id_area
	        LEFT JOIN empleado r ON r.id_empleado = ad.id_empleado_remi
	        LEFT JOIN area ar_r ON ar_r.id_area = r.id_area
	        LEFT JOIN empleado i ON i.id_empleado = ad.id_empleado_ini
	        LEFT JOIN area ar_i ON ar_i.id_area = i.id_area
	        LEFT JOIN expediente e ON e.id_expediente = a.id_expediente
		LEFT JOIN tema t ON t.id_tema = a.id_tema
		LEFT JOIN instruccion ins ON ins.id_instruccion = a.id_instruccion
                LEFT JOIN evento ev ON ev.id_evento = a.id_evento
        <dynamic prepend="WHERE">
            <isNotEmpty prepend="" property="ids_estatus">
                <iterate prepend="AND" property="ids_estatus"
			  			open="(" close=")" conjunction="OR">
							ad.estatus =#ids_estatus[]#
                </iterate>
            </isNotEmpty>
            <isNotNull prepend="" property="estatus">
                <isNotEqual prepend="AND" property="estatus" compareValue="">
                    <isLessEqual prepend="" property="estatus" compareValue="3">
							ad.estatus = #estatus#
                    </isLessEqual>
                    <isEqual prepend="" property="estatus" compareValue="4">
							<![CDATA[
						    	(SELECT
								    CASE to_number(to_char(ad3.fh_limite-2,'d'))
								    WHEN 7 THEN ad3.fh_limite-4
								    WHEN 6 THEN ad3.fh_limite-4
								    ELSE ad3.fh_limite-2 END
							    FROM asunto_detalle ad3
							    WHERE ad.id_asunto_detalle = ad3.id_asunto_detalle) > sysdate
							]]>
                    </isEqual>
                    <isEqual prepend="" property="estatus" compareValue="5">
							<![CDATA[
						    	(SELECT
								    CASE to_number(to_char(ad4.fh_limite-2,'d'))
								    WHEN 7 THEN ad4.fh_limite-4
								    WHEN 6 THEN ad4.fh_limite-4
								    ELSE ad4.fh_limite-2 END
							    FROM asunto_detalle ad4
							    WHERE ad.id_asunto_detalle = ad4.id_asunto_detalle) <= sysdate
							    AND ad.fh_limite > to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
							]]>
                    </isEqual>
                    <isEqual prepend="" property="estatus" compareValue="6">
							<![CDATA[
								ad.fh_limite <= to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
							]]>
                    </isEqual>
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="ids_asunto">
                <iterate prepend="AND" property="ids_asunto"
				  		open="(" close=")" conjunction="OR">
				  		a.id_asunto=#ids_asunto[]#
                </iterate>
            </isNotNull>
            <isNotNull prepend="" property="id_asunto">
                <isNotEqual prepend="AND" property="id_asunto" compareValue="">
						a.id_asunto = #id_asunto#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="asunto">
                <isNotEqual prepend="AND" property="asunto" compareValue="">
						a.asunto LIKE '%$asunto$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="descripcion">
                <isNotEqual prepend="AND" property="descripcion" compareValue="">
						a.descripcion LIKE '%$descripcion$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="no_oficio">
                <isNotEqual prepend="AND" property="no_oficio" compareValue="">
						a.no_oficio LIKE '%$no_oficio$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
		 				a.fh_oficio BETWEEN #fh_oficio_ini# AND #fh_oficio_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_recepcion_ini">
                <isNotNull prepend="AND" property="fh_recepcion_fin">
		 				a.fh_recepcion BETWEEN #fh_recepcion_ini# AND #fh_recepcion_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_lectura_ini">
                <isNotNull prepend="AND" property="fh_lectura_fin">
		  				ad.fh_lectura BETWEEN #fh_lectura_ini# AND #fh_lectura_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
		  				ad.fh_registro BETWEEN #fh_registro_ini# AND #fh_registro_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="AND" property="fh_limite_ini">
		  				ad.fh_limite = #fh_limite_ini#
            </isNotNull>
            <isNotNull prepend="" property="id_prioridad">
                <isGreaterThan prepend="AND" property="id_prioridad" compareValue="-1">
                    ad.id_prioridad = #id_prioridad#
                </isGreaterThan>
            </isNotNull>
            <isNotNull prepend="" property="id_area_capt">
                <isNotEqual prepend="AND" property="id_area_capt" compareValue="">
						c.id_area = #id_area_capt#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_capt">
                <isNotEqual prepend="AND" property="nombre_capt" compareValue="">
						c.nombre LIKE '%$nombre_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_capt">
                <isNotEqual prepend="AND" property="paterno_capt" compareValue="">
						c.paterno LIKE '%$paterno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_capt">
                <isNotEqual prepend="AND" property="materno_capt" compareValue="">
						c.materno LIKE '%$materno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_empleado_remi">
                <isNotEqual prepend="AND" property="id_empleado_remi" compareValue="">
						r.id_empleado = #id_empleado_remi#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_area_remi">
                <isNotEqual prepend="AND" property="id_area_remi" compareValue="">
						r.id_area = #id_area_remi#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_remi">
                <isNotEqual prepend="AND" property="nombre_remi" compareValue="">
						r.nombre LIKE '%$nombre_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_remi">
                <isNotEqual prepend="AND" property="paterno_remi" compareValue="">
						r.paterno LIKE '%$paterno_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_remi">
                <isNotEqual prepend="AND" property="materno_remi" compareValue="">
						r.materno LIKE '%$materno_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_empleado_dest">
                <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
						d.id_empleado = #id_empleado_dest#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_area_dest">
                <isNotEqual prepend="AND" property="id_area_dest" compareValue="">
						d.id_area = #id_area_dest#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_dest">
                <isNotEqual prepend="AND" property="nombre_dest" compareValue="">
						d.nombre LIKE '%$nombre_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_dest">
                <isNotEqual prepend="AND" property="paterno_dest" compareValue="">
						d.paterno LIKE '%$paterno_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_dest">
                <isNotEqual prepend="AND" property="materno_dest" compareValue="">
						d.materno LIKE '%$materno_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_tema">
                <isNotEqual prepend="AND" property="id_tema" compareValue="-1">
						a.id_tema = #id_tema#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_expediente">
                <isNotEqual prepend="AND" property="id_expediente" compareValue="-1">
						a.id_expediente = #id_expediente#
                </isNotEqual>
            </isNotNull>
        </dynamic>
			ORDER BY a.id_asunto DESC, ad.id_asunto_detalle ASC
		) vista WHERE ROWNUM<![CDATA[ <= ]]>#paginador.maximo#
	    ) WHERE r<![CDATA[ >= ]]>#paginador.minimo#
    </select>


    <select id="countByCriterio" parameterClass="mx.gob.economia.scg.model.CriterioAsunto" resultClass="java.lang.Integer">
		SELECT
            COUNT(1)
        FROM asunto a
        LEFT JOIN empleado c ON c.id_empleado = a.id_empleado_capt
        LEFT JOIN area ac ON ac.id_area = c.id_area
        LEFT JOIN asunto_detalle ad ON a.id_asunto = ad.id_asunto
        LEFT JOIN empleado d ON d.id_empleado = ad.id_empleado_dest
        LEFT JOIN area ar_d ON ar_d.id_area = d.id_area
        LEFT JOIN empleado r ON r.id_empleado = ad.id_empleado_remi
        LEFT JOIN area ar_r ON ar_r.id_area = r.id_area
        <dynamic prepend="WHERE">
            <isNotEmpty prepend="" property="ids_estatus">
                <iterate prepend="AND" property="ids_estatus"
		  			open="(" close=")" conjunction="OR">
						ad.estatus =#ids_estatus[]#
                </iterate>
            </isNotEmpty>
            <isNotNull prepend="" property="estatus">
                <isNotEqual prepend="AND" property="estatus" compareValue="">
                    <isLessEqual prepend="" property="estatus" compareValue="3">
						ad.estatus = #estatus#
                    </isLessEqual>
                    <isEqual prepend="" property="estatus" compareValue="4">
						<![CDATA[
					    	(SELECT
							    CASE to_number(to_char(ad3.fh_limite-2,'d'))
							    WHEN 7 THEN ad3.fh_limite-4
							    WHEN 6 THEN ad3.fh_limite-4
							    ELSE ad3.fh_limite-2 END
						    FROM asunto_detalle ad3
						    WHERE ad.id_asunto_detalle = ad3.id_asunto_detalle) > sysdate
						]]>
                    </isEqual>
                    <isEqual prepend="" property="estatus" compareValue="5">
						<![CDATA[
					    	(SELECT
							    CASE to_number(to_char(ad4.fh_limite-2,'d'))
							    WHEN 7 THEN ad4.fh_limite-4
							    WHEN 6 THEN ad4.fh_limite-4
							    ELSE ad4.fh_limite-2 END
						    FROM asunto_detalle ad4
						    WHERE ad.id_asunto_detalle = ad4.id_asunto_detalle) <= sysdate
						    AND ad.fh_limite > to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
						]]>
                    </isEqual>
                    <isEqual prepend="" property="estatus" compareValue="6">
						<![CDATA[
							ad.fh_limite <= to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
						]]>
                    </isEqual>
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="ids_asunto">
                <iterate prepend="AND" property="ids_asunto"
			  		open="(" close=")" conjunction="OR">
			  		a.id_asunto=#ids_asunto[]#
                </iterate>
            </isNotNull>
            <isNotNull prepend="" property="id_asunto">
                <isNotEqual prepend="AND" property="id_asunto" compareValue="">
					a.id_asunto = #id_asunto#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="asunto">
                <isNotEqual prepend="AND" property="asunto" compareValue="">
					a.asunto LIKE '%$asunto$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="descripcion">
                <isNotEqual prepend="AND" property="descripcion" compareValue="">
					a.descripcion LIKE '%$descripcion$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="no_oficio">
                <isNotEqual prepend="AND" property="no_oficio" compareValue="">
					a.no_oficio LIKE '%$no_oficio$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
	 				a.fh_oficio BETWEEN #fh_oficio_ini# AND #fh_oficio_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_recepcion_ini">
                <isNotNull prepend="AND" property="fh_recepcion_fin">
		 				a.fh_recepcion BETWEEN #fh_recepcion_ini# AND #fh_recepcion_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_lectura_ini">
                <isNotNull prepend="AND" property="fh_lectura_fin">
	  				ad.fh_lectura BETWEEN #fh_lectura_ini# AND #fh_lectura_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
	  				ad.fh_registro BETWEEN #fh_registro_ini# AND #fh_registro_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_limite_ini">
                <isNotNull prepend="AND" property="fh_limite_fin">
	  				ad.fh_limite BETWEEN #fh_limite_ini# AND #fh_limite_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="id_area_capt">
                <isNotEqual prepend="AND" property="id_area_capt" compareValue="">
					c.id_area = #id_area_capt#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_capt">
                <isNotEqual prepend="AND" property="nombre_capt" compareValue="">
					c.nombre LIKE '%$nombre_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_capt">
                <isNotEqual prepend="AND" property="paterno_capt" compareValue="">
					c.paterno LIKE '%$paterno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_capt">
                <isNotEqual prepend="AND" property="materno_capt" compareValue="">
					c.materno LIKE '%$materno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_empleado_remi">
                <isNotEqual prepend="AND" property="id_empleado_remi" compareValue="">
					r.id_empleado = #id_empleado_remi#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_area_remi">
                <isNotEqual prepend="AND" property="id_area_remi" compareValue="">
					r.id_area = #id_area_remi#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_remi">
                <isNotEqual prepend="AND" property="nombre_remi" compareValue="">
					r.nombre LIKE '%$nombre_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_remi">
                <isNotEqual prepend="AND" property="paterno_remi" compareValue="">
					r.paterno LIKE '%$paterno_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_remi">
                <isNotEqual prepend="AND" property="materno_remi" compareValue="">
					r.materno LIKE '%$materno_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_empleado_dest">
                <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
					d.id_empleado = #id_empleado_dest#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_area_dest">
                <isNotEqual prepend="AND" property="id_area_dest" compareValue="">
					d.id_area = #id_area_dest#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_dest">
                <isNotEqual prepend="AND" property="nombre_dest" compareValue="">
					d.nombre LIKE '%$nombre_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_dest">
                <isNotEqual prepend="AND" property="paterno_dest" compareValue="">
					d.paterno LIKE '%$paterno_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_dest">
                <isNotEqual prepend="AND" property="materno_dest" compareValue="">
					d.materno LIKE '%$materno_dest$%'
                </isNotEqual>
            </isNotNull>
        </dynamic>
        AND ROWNUM <![CDATA[ <= ]]>#paginador.numMaxRegistros#
    </select>


    <select id="listInicialesByCriterio" parameterClass="mx.gob.economia.scg.model.CriterioAsunto" resultMap="asuntoDetalleMap">
    SELECT * FROM (
	SELECT vista.*, rownum r FROM(
         SELECT a.folio, 
                a.id_asunto, a.asunto, a.descripcion, a.no_oficio, a.fh_oficio, a.fh_recepcion, a.id_empleado_capt,
                CASE to_number(to_char(ad.fh_limite-2,'d'))
                WHEN 7 THEN ad.fh_limite-4
                WHEN 6 THEN ad.fh_limite-4
                ELSE ad.fh_limite-2 END AS fh_por_vencer, a.estatus,
                c.correo AS correo_capt, c.nombre AS nombre_capt,
                c.paterno AS paterno_capt, c.materno AS materno_capt,
                c.id_area AS id_area_capt, ac.area AS area_capt, c.activo AS activo_capt, c.puesto AS puesto_capt,
                ad.id_asunto_detalle, ad.fh_lectura, ad.fh_registro, ad.fh_limite, ad.comentario, ad.ip,
                r.id_empleado AS id_empleado_remi, r.correo AS correo_remi, r.nombre AS nombre_remi,
                r.paterno AS paterno_remi, r.materno AS materno_remi,
                r.id_area AS id_area_remi, ar_r.area AS area_remi, r.activo AS activo_remi, r.puesto AS puesto_remi,
                d.id_empleado AS id_empleado_dest, d.correo AS correo_dest, d.nombre AS nombre_dest,
                d.paterno AS paterno_dest, d.materno AS materno_dest,
                d.id_area AS id_area_dest, ar_d.area AS area_dest, d.activo AS activo_dest, d.puesto AS puesto_dest,
                i.id_empleado AS id_empleado_ini, i.correo AS correo_ini, i.nombre AS nombre_ini,
                i.paterno AS paterno_ini, i.materno AS materno_ini,
                i.id_area AS id_area_ini, ar_i.area AS area_ini, i.activo AS activo_ini, i.puesto AS puesto_ini, a.id_asunto_padre,
                a.id_expediente, e.expediente, a.id_tema, t.id_tema_padre, t.tema, t.evento tema_evento, a.fh_evento, 
                a.id_instruccion, ins.instruccion, a.id_tipo_asunto, ad.id_prioridad, a.antecedente, a.confidencial,
                a.folio || '-' || a.contador_folio contador_folio,
                (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) atencionParcial
            FROM asunto a,
               empleado c,
               empleado empleadoRemiAsunto,
               area areaRemiAsunto,
               empleado empleadoDestAsunto,
               area areaDestAsunto,
               area ac,
               asunto_detalle ad,
               empleado d,
               area ar_d,
               empleado r,
               area ar_r,
               empleado i,
               area ar_i,
               expediente e,
               tema t,
               instruccion ins
            where a.id_empleado_capt = c.id_empleado
            and a.ID_EMPLEADO_REMI = empleadoRemiAsunto.id_empleado
            and a.ID_EMPLEADO_DEST = empleadoDestAsunto.id_empleado
            and a.id_asunto = ad.id_asunto
            and a.id_expediente = e.id_expediente(+)
            and a.id_tema = t.id_tema(+)
            and a.id_instruccion = ins.id_instruccion
            and c.id_area = ac.id_area
            and empleadoRemiAsunto.id_area = areaRemiAsunto.id_area
            and empleadoDestAsunto.id_area = areaDestAsunto.id_area
            and ad.id_empleado_remi  = r.id_empleado
            and ad.id_empleado_dest  = d.id_empleado
            and ad.id_empleado_ini = i.id_empleado(+)
            and d.id_area  = ar_d.id_area
            and r.id_area = ar_r.id_area
            and i.id_area = ar_i.id_area(+)
        <dynamic prepend="">

            <isNotNull prepend="" property="estatus">
                <isNotEqual prepend="" property="estatus" compareValue="">
                    <isEqual prepend="AND" property="estatus" compareValue="0">
                                a.estatus = #estatus#
                                and (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) =0
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="1">
                                a.estatus = #estatus#
                                and (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) =0
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="2">
                                a.estatus = #estatus#
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="3">
                                a.estatus = #estatus#
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="7">
                                        a.estatus = #estatus#
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="14">
                                        (a.estatus = 0 OR a.estatus = 1)
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="4">
							<![CDATA[
						    	(SELECT
								    CASE to_number(to_char(ad3.fh_limite-2,'d'))
								    WHEN 7 THEN ad3.fh_limite-4
								    WHEN 6 THEN ad3.fh_limite-4
								    ELSE ad3.fh_limite-2 END
							    FROM asunto_detalle ad3
							    WHERE ad.id_asunto_detalle = ad3.id_asunto_detalle) > sysdate
							]]>
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="5">
							<![CDATA[
						    	(SELECT
								    CASE to_number(to_char(ad4.fh_limite-2,'d'))
								    WHEN 7 THEN ad4.fh_limite-4
								    WHEN 6 THEN ad4.fh_limite-4
								    ELSE ad4.fh_limite-2 END
							    FROM asunto_detalle ad4
							    WHERE ad.id_asunto_detalle = ad4.id_asunto_detalle) <= sysdate
							    AND ad.fh_limite > to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
							]]>
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="6">
							<![CDATA[
								ad.fh_limite <= to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
							]]>
                    </isEqual>
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="ids_asunto">
                <iterate prepend="AND" property="ids_asunto"
				  		open="(" close=")" conjunction="OR">
				  		a.id_asunto=#ids_asunto[]#
                </iterate>
            </isNotNull>
            <isNotNull prepend="" property="folio">
                <isNotEqual prepend="AND" property="folio" compareValue="">
						a.folio LIKE '$folio$'
                </isNotEqual>
            </isNotNull>

             <!--inicio AGG Filtro por referencia 20111107 -->
            <isNotNull prepend="" property="id_asunto_ref">
                <isNotEqual prepend="AND" property="id_asunto_ref" compareValue="">
						a.id_asunto_ref LIKE upper('%$id_asunto_ref$%')
                </isNotEqual>
            </isNotNull>
            <!--fin AGG Filtro por referencia 20111107 -->

            <isNotNull prepend="" property="id_asunto">
                <isNotEqual prepend="AND" property="id_asunto" compareValue="">
						a.id_asunto = #id_asunto#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="asunto">
                <isNotEqual prepend="AND" property="asunto" compareValue="">
						a.asunto LIKE '%$asunto$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="descripcion">
                <isNotEqual prepend="AND" property="descripcion" compareValue="">
						a.descripcion LIKE '%$descripcion$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="no_oficio">
                <isNotEqual prepend="AND" property="no_oficio" compareValue="">
						a.no_oficio LIKE '%$no_oficio$%'
                </isNotEqual>
            </isNotNull>

            <isNotNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio BETWEEN #fh_oficio_ini# AND #fh_oficio_fin#
                </isNotNull>
                <isNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio BETWEEN #fh_oficio_ini# AND SYSDATE
                </isNull>
            </isNotNull>
            <isNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio = #fh_oficio_fin#
                </isNotNull>
            </isNull>

            <isNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio = #fh_oficio_fin#
                </isNotNull>
            </isNull>

            <isNotNull prepend="" property="fh_recepcion_ini">
                <isNotNull prepend="AND" property="fh_recepcion_fin">
		 				a.fh_recepcion BETWEEN #fh_recepcion_ini# AND #fh_recepcion_fin#
                </isNotNull>
            </isNotNull>

            <isNotNull prepend="" property="fh_lectura_ini">
                <isNotNull prepend="AND" property="fh_lectura_fin">
					ad.fh_lectura BETWEEN #fh_lectura_ini# AND #fh_lectura_fin#
                </isNotNull>
                <isNull prepend="AND" property="fh_lectura_fin">
					ad.fh_lectura BETWEEN #fh_lectura_ini# AND SYSDATE
                </isNull>
            </isNotNull>
            <isNull prepend="" property="fh_lectura_ini">
                <isNotNull prepend="AND" property="fh_lectura_fin">
					ad.fh_lectura = #fh_lectura_fin#
                </isNotNull>
            </isNull>

            <isNotNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
					ad.fh_registro BETWEEN #fh_registro_ini# AND #fh_registro_fin#
            </isNotNull>
                <isNull prepend="AND" property="fh_registro_fin">
					ad.fh_registro BETWEEN #fh_registro_ini# AND SYSDATE
                </isNull>
            </isNotNull>
            <isNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
					ad.fh_registro = #fh_registro_fin#
                </isNotNull>
            </isNull>

            <isNotNull prepend="" property="fh_limite_ini">
                <isNotNull prepend="AND" property="fh_limite_fin">
					ad.fh_limite BETWEEN #fh_limite_ini# AND #fh_limite_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="AND" property="fh_limite_ini">
				ad.fh_limite = #fh_limite_ini#
            </isNotNull>
            <isNotNull prepend="" property="id_prioridad">
                <isGreaterThan prepend="AND" property="id_prioridad" compareValue="-1">
                    ad.id_prioridad = #id_prioridad#
                </isGreaterThan>
            </isNotNull>
            <isNotNull prepend="" property="id_tipo_documento">
                <isGreaterThan prepend="AND" property="id_tipo_documento" compareValue="-1">
                    a.id_tipo_asunto = #id_tipo_documento#
                </isGreaterThan>
            </isNotNull>
            <isNotNull prepend="" property="nombre_capt">
                <isNotEqual prepend="AND" property="nombre_capt" compareValue="">
						c.nombre LIKE '%$nombre_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_capt">
                <isNotEqual prepend="AND" property="paterno_capt" compareValue="">
						c.paterno LIKE '%$paterno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_capt">
                <isNotEqual prepend="AND" property="materno_capt" compareValue="">
						c.materno LIKE '%$materno_capt$%'
                </isNotEqual>
            </isNotNull><isNotNull prepend="" property="id_tema">
                <isNotEqual prepend="AND" property="id_tema" compareValue="-1">
						a.id_tema = #id_tema#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_expediente">
                <isNotEqual prepend="AND" property="id_expediente" compareValue="-1">
						a.id_expediente = #id_expediente#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_evento">
                <isNotEqual prepend="AND" property="id_evento" compareValue="-1">
						a.id_evento = #id_evento#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_area_capt">
                <isNotEqual prepend="AND" property="id_area_capt" compareValue="">
                    (c.id_area = #id_area_capt#
                    or empleadoRemiAsunto.ID_AREA = #id_area_capt#
                    or empleadoDestAsunto.ID_AREA = #id_area_capt#)
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="ids_empleados_ccp">
                <isNotEqual prepend="AND" property="ids_empleados_ccp" compareValue="">
                     (a.id_asunto in (select distinct id_asunto
                                      from asunto_detalle
                                      WHERE id_asunto_detalle IN (SELECT id_asunto_detalle
                                                                  FROM asunto_detalle_ccp
                                                                  WHERE id_empleado in ($ids_empleados_ccp$))
                                         or id_asunto_detalle IN (SELECT id_asunto_detalle
                                                                  FROM ASUNTO_ATT_PARC_CCP_CAPT
                                                                  WHERE id_empleado in ($ids_empleados_ccp$)))
                       or a.id_asunto in (SELECT id_asunto
                                          FROM asunto_ccp
                                          WHERE id_empleado in ($ids_empleados_ccp$)))
                </isNotEqual>
            </isNotNull>

            <isNotNull prepend="" property="confidencial">
                <isEqual prepend="AND" property="confidencial" compareValue="1" >
                                        a.confidencial = 1
                </isEqual>
                <isEqual prepend="AND" property="confidencial" compareValue="0" >
                                        a.confidencial = 0
                </isEqual>
            </isNotNull>
            <isNotNull prepend="" property="enTramite">
                <isEqual prepend="AND" property="enTramite" compareValue="1" >
                            (a.estatus = 0 OR a.estatus = 1)
                            and (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) >0
                </isEqual>
                <!--
                <isEqual prepend="AND" property="enTramite" compareValue="0" >
                                        (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) =0
                </isEqual>
                -->
            </isNotNull>
            <isEqual prepend="" property="busqueda_detalle" compareValue="0">
                and ad.id_asunto_detalle =  (select max(ID_ASUNTO_DETALLE) from asunto_detalle ad2 WHERE ad2.id_asunto = a.id_asunto)
                <isEqual prepend="AND" property="busqueda_modificado" compareValue="1">
                    a.estatus != 3                    
                    and a.id_asunto in (SELECT id_asunto
                                        FROM asunto_captura_actualizacion a
                                        WHERE a.estatus !=7
                                          and a.tipo_actualizacion = 0
                                          and id_empleado_dest = #id_empleado_dest#)
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="1">
                    ar_r.tipo = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="2">
                    ar_r.tipo = 1
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="1">
                    ar_d.tipo = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="2">
                    ar_d.tipo = 1
                </isEqual>

                <isNotNull prepend="" property="id_empleado_remi">
                    <isNotEqual prepend="AND" property="id_empleado_remi" compareValue="">
						a.id_empleado_remi = #id_empleado_remi#
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="id_area_remi">
                    <isNotEqual prepend="AND" property="id_area_remi" compareValue="">
						r.id_area = #id_area_remi#
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="nombre_remi">
                    <isNotEqual prepend="AND" property="nombre_remi" compareValue="">
						r.nombre LIKE '%$nombre_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_remi">
                    <isNotEqual prepend="AND" property="paterno_remi" compareValue="">
						r.paterno LIKE '%$paterno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_remi">
                    <isNotEqual prepend="AND" property="materno_remi" compareValue="">
						r.materno LIKE '%$materno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isEqual prepend="" property="busqueda_modificado" compareValue="0">
                    <isNotNull prepend="" property="id_empleado_dest">
                        <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                                    a.id_empleado_dest = #id_empleado_dest#
                        </isNotEqual>
                    </isNotNull>
                </isEqual>
                <isNotNull prepend="" property="id_area_dest">
                    <isNotEqual prepend="AND" property="id_area_dest" compareValue="">
						d.id_area = #id_area_dest#
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="nombre_dest">
                    <isNotEqual prepend="AND" property="nombre_dest" compareValue="">
						d.nombre LIKE '%$nombre_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_dest">
                    <isNotEqual prepend="AND" property="paterno_dest" compareValue="">
						d.paterno LIKE '%$paterno_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_dest">
                    <isNotEqual prepend="AND" property="materno_dest" compareValue="">
						d.materno LIKE '%$materno_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotEmpty prepend="" property="ids_estatus">
                    <iterate prepend="AND" property="ids_estatus"
                             open="(" close=")" conjunction="OR">
				   a.estatus =#ids_estatus[]#
                    </iterate>
                </isNotEmpty>
            </isEqual>
            <isEqual prepend="" property="busqueda_detalle" compareValue="1">
                <isEmpty prepend="" property="historico">
                    and ad.id_asunto_detalle =  (select max(ID_ASUNTO_DETALLE) from asunto_detalle ad2 WHERE ad2.id_asunto = a.id_asunto)
                </isEmpty>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="1">
                    (select a2.tipo from area a2 where a2.id_area =(select e2.id_area from empleado e2 where e2.id_empleado = ad.id_empleado_remi)) = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="2">
                    (select a2.tipo from area a2 where a2.id_area =(select e2.id_area from empleado e2 where e2.id_empleado = ad.id_empleado_remi)) = 1
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="1">
                    (select a3.tipo from area a3 where a3.id_area =(select e3.id_area from empleado e3 where e3.id_empleado = ad.id_empleado_dest)) = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="2">
                    (select a3.tipo from area a3 where a3.id_area =(select e3.id_area from empleado e3 where e3.id_empleado = ad.id_empleado_dest)) = 1
                </isEqual>
                <isNotEmpty prepend="" property="ids_estatus">
                    <iterate prepend="AND" property="ids_estatus"
                             open="(" close=")" conjunction="OR">
				   ad.estatus =#ids_estatus[]#
                    </iterate>
                </isNotEmpty>

		<isNotNull prepend="" property="id_empleado_recep">
                    <isNotEqual prepend="AND" property="id_empleado_recep" compareValue="">
                        (SELECT ar.id_empleado FROM asunto_recepcion ar where ar.id_asunto = ad.id_asunto and ar.id_asunto_detalle = ad.id_asunto_detalle and ar.id_empleado = #id_empleado_recep#) = #id_empleado_recep#
                    </isNotEqual>
		</isNotNull>

                <isNotNull prepend="" property="id_empleado_remi">
                    <isNotEqual prepend="" property="id_empleado_remi" compareValue="">
                        <isNotNull prepend="" property="id_empleado_dest">
                            <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                (ad.id_empleado_remi = #id_empleado_remi#
                                 or ad.id_empleado_dest = #id_empleado_dest#)
                            </isNotEqual>
                        </isNotNull>
                        <isEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                ad.id_empleado_remi = #id_empleado_remi#
                        </isEqual>
                    </isNotEqual>
                </isNotNull>
                <isEqual prepend="" property="id_empleado_remi" compareValue="">
                    <isNotNull prepend="" property="id_empleado_dest">
                            <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                ad.id_empleado_dest = #id_empleado_dest#
                            </isNotEqual>
                    </isNotNull>
                </isEqual>

                <isNotNull prepend="" property="id_area_remi">
                    <isNotEqual prepend="AND" property="id_area_remi" compareValue="">
						(select erd.id_area from empleado erd where erd.id_empleado = ad.id_empleado_remi) = #id_area_remi#
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="nombre_remi">
                    <isNotEqual prepend="AND" property="nombre_remi" compareValue="">
						(select erd.nombre from empleado erd where erd.id_empleado = ad.id_empleado_remi) LIKE '%$nombre_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_remi">
                    <isNotEqual prepend="AND" property="paterno_remi" compareValue="">
						(select erd.paterno from empleado erd where erd.id_empleado = ad.id_empleado_remi) LIKE '%$paterno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_remi">
                    <isNotEqual prepend="AND" property="materno_remi" compareValue="">
						(select erd.materno from empleado erd where erd.id_empleado = ad.id_empleado_remi) LIKE '%$materno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="id_area_dest">
                    <isNotEqual prepend="AND" property="id_area_dest" compareValue="">
						(select erd.id_area from empleado erd where erd.id_empleado = ad.id_empleado_dest) = #id_area_dest#
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="nombre_dest">
                    <isNotEqual prepend="AND" property="nombre_dest" compareValue="">
						(select erd.nombre from empleado erd where erd.id_empleado = ad.id_empleado_dest) LIKE '%$nombre_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_dest">
                    <isNotEqual prepend="AND" property="paterno_dest" compareValue="">
						(select erd.paterno from empleado erd where erd.id_empleado = ad.id_empleado_dest) LIKE '%$paterno_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_dest">
                    <isNotEqual prepend="AND" property="materno_dest" compareValue="">
						(select erd.materno from empleado erd where erd.id_empleado = ad.id_empleado_dest) LIKE '%$materno_dest$%'
                    </isNotEqual>
                </isNotNull>
            </isEqual>

        </dynamic>
                        order by ad.fh_registro desc
			<!--
                            Orden que traia antes en las bandejas. Comentado por Rodolfo Milano.
                            Se solicito que se ordenara por la fecha de creacin del asunto
                            order by to_number(replace(substr(folio,instr(folio,'-',1,1)+1,instr(folio,'-',1,2)-instr(folio,'-',1,1)-1),'C','')) desc,
                                 to_number(replace(substr(folio,instr(folio,'-',1,2)+1),'C','')) desc,
                                 contador_folio desc -->
		) vista WHERE ROWNUM<![CDATA[ <= ]]>#paginador.maximo#
	    ) WHERE r<![CDATA[ >= ]]>#paginador.minimo#
    </select>
    <select id="listIdsAsuntoInicialesByCriterio" parameterClass="mx.gob.economia.scg.model.CriterioAsunto" resultClass="java.lang.String">
                SELECT a.id_asunto
	        FROM asunto a
	        LEFT JOIN empleado c ON c.id_empleado = a.id_empleado_capt
                LEFT JOIN empleado empleadoRemiAsunto ON empleadoRemiAsunto.id_empleado = a.ID_EMPLEADO_REMI
                LEFT JOIN area areaRemiAsunto ON areaRemiAsunto.id_area = empleadoRemiAsunto.id_area
                LEFT JOIN empleado empleadoDestAsunto ON empleadoDestAsunto.id_empleado = a.ID_EMPLEADO_DEST
                LEFT JOIN area areaDestAsunto ON areaDestAsunto.id_area = empleadoDestAsunto.id_area
	        LEFT JOIN area ac ON ac.id_area = c.id_area
	        LEFT JOIN asunto_detalle ad ON a.id_asunto = ad.id_asunto
	        LEFT JOIN empleado d ON d.id_empleado = ad.id_empleado_dest
	        LEFT JOIN area ar_d ON ar_d.id_area = d.id_area
	        LEFT JOIN empleado r ON r.id_empleado = ad.id_empleado_remi
	        LEFT JOIN area ar_r ON ar_r.id_area = r.id_area
	        LEFT JOIN empleado i ON i.id_empleado = ad.id_empleado_ini
	        LEFT JOIN area ar_i ON ar_i.id_area = i.id_area
	        LEFT JOIN expediente e ON e.id_expediente = a.id_expediente
			LEFT JOIN tema t ON t.id_tema = a.id_tema
			LEFT JOIN instruccion ins ON ins.id_instruccion = a.id_instruccion
        <dynamic prepend="">
            <isNotEqual prepend="" property="id_empleado_ccp" compareValue="">
	        		INNER JOIN asunto_ccp ccp ON ccp.ID_ASUNTO= a.ID_ASUNTO AND ccp.ID_EMPLEADO = #id_empleado_ccp#
            </isNotEqual>
        </dynamic>
        <dynamic prepend="">
            <isNotEqual prepend="" property="id_empleado_recep" compareValue="">
			        INNER JOIN asunto_recepcion ar ON ar.id_asunto = a.id_asunto
			        AND ar.id_asunto_detalle= ad.id_asunto_detalle AND ar.ID_EMPLEADO = #id_empleado_recep#
            </isNotEqual>
        </dynamic>
        <isEqual prepend="" property="tipo_area_remi" compareValue="0">
	        WHERE ad.id_asunto_detalle =
                    (select min(ID_ASUNTO_DETALLE) from asunto_detalle ad2 WHERE ad2.id_asunto = a.id_asunto)
        </isEqual>
        <isEqual prepend="" property="tipo_area_remi" compareValue="1">
	        WHERE ar_r.tipo = 0
                  and ad.id_asunto_detalle =
	            (SELECT min(ad2.id_asunto_detalle) FROM asunto_detalle ad2 WHERE ad2.id_asunto = a.id_asunto)

        </isEqual>
        <isEqual prepend="" property="tipo_area_remi" compareValue="2">
	        WHERE ar_r.tipo = 1
                   and ad.id_asunto_detalle =
	            (SELECT min(ad2.id_asunto_detalle) FROM asunto_detalle ad2 WHERE ad2.id_asunto = a.id_asunto)
        </isEqual>


        <dynamic prepend="">

            <isEqual prepend="" property="tipo_area_dest" compareValue="1">
	        and ar_d.tipo = 0
            </isEqual>
            <isEqual prepend="" property="tipo_area_dest" compareValue="2">
	        and ar_d.tipo = 1
            </isEqual>

            <isNotEmpty prepend="" property="ids_estatus">
                <iterate prepend="AND" property="ids_estatus"
			  			open="(" close=")" conjunction="OR">
							ad.estatus =#ids_estatus[]#
                </iterate>
            </isNotEmpty>
            <isNotNull prepend="" property="estatus">
                <isNotEqual prepend="AND" property="estatus" compareValue="">
                    <isLessEqual prepend="" property="estatus" compareValue="3">
							a.estatus = #estatus#
                    </isLessEqual>
                    <isGreaterThan prepend="" property="estatus" compareValue="6">
							a.estatus = #estatus#
                    </isGreaterThan>
                    <isEqual prepend="" property="estatus" compareValue="4">
							<![CDATA[
						    	(SELECT
								    CASE to_number(to_char(ad3.fh_limite-2,'d'))
								    WHEN 7 THEN ad3.fh_limite-4
								    WHEN 6 THEN ad3.fh_limite-4
								    ELSE ad3.fh_limite-2 END
							    FROM asunto_detalle ad3
							    WHERE ad.id_asunto_detalle = ad3.id_asunto_detalle) > sysdate
							]]>
                    </isEqual>
                    <isEqual prepend="" property="estatus" compareValue="5">
							<![CDATA[
						    	(SELECT
								    CASE to_number(to_char(ad4.fh_limite-2,'d'))
								    WHEN 7 THEN ad4.fh_limite-4
								    WHEN 6 THEN ad4.fh_limite-4
								    ELSE ad4.fh_limite-2 END
							    FROM asunto_detalle ad4
							    WHERE ad.id_asunto_detalle = ad4.id_asunto_detalle) <= sysdate
							    AND ad.fh_limite > to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
							]]>
                    </isEqual>
                    <isEqual prepend="" property="estatus" compareValue="6">
							<![CDATA[
								ad.fh_limite <= to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
							]]>
                    </isEqual>
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="ids_asunto">
                <iterate prepend="AND" property="ids_asunto"
				  		open="(" close=")" conjunction="OR">
				  		a.id_asunto=#ids_asunto[]#
                </iterate>
            </isNotNull>
            <isNotNull prepend="" property="folio">
                <isNotEqual prepend="AND" property="folio" compareValue="">
						a.folio LIKE '$folio$'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="antecedente">
                <isNotEqual prepend="AND" property="antecedente" compareValue="">
						a.antecedente LIKE upper('%$antecedente$%')
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_asunto_ref">
                <isNotEqual prepend="AND" property="id_asunto_ref" compareValue="" >
                                        a.id_asunto_ref LIKE upper('%$id_asunto_ref$%')
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="confidencial">
                <isEqual prepend="AND" property="confidencial" compareValue="1" >
                                        a.confidencial = 1
                </isEqual>
                <isEqual prepend="AND" property="confidencial" compareValue="0" >
                                        a.confidencial = 0
                </isEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_asunto">
                <isNotEqual prepend="AND" property="id_asunto" compareValue="">
						a.id_asunto = #id_asunto#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="asunto">
                <isNotEqual prepend="AND" property="asunto" compareValue="">
						a.asunto LIKE '%$asunto$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="descripcion">
                <isNotEqual prepend="AND" property="descripcion" compareValue="">
						a.descripcion LIKE '%$descripcion$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="no_oficio">
                <isNotEqual prepend="AND" property="no_oficio" compareValue="">
						a.no_oficio LIKE '%$no_oficio$%'
                </isNotEqual>
            </isNotNull>

            <isNotNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
		 	a.fh_oficio BETWEEN #fh_oficio_ini# AND #fh_oficio_fin#
                </isNotNull>
                <isNull prepend="AND" property="fh_oficio_fin">
		 	a.fh_oficio BETWEEN #fh_oficio_ini# AND SYSDATE
                </isNull>
            </isNotNull>
            <isNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
		 	a.fh_oficio = #fh_oficio_fin#
                </isNotNull>
            </isNull>

            <isNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
		 	a.fh_oficio = #fh_oficio_fin#
                </isNotNull>
            </isNull>
            <isNotNull prepend="" property="fh_recepcion_ini">
                <isNotNull prepend="AND" property="fh_recepcion_fin">
		 				a.fh_recepcion BETWEEN #fh_recepcion_ini# AND #fh_recepcion_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_lectura_ini">
                <isNotNull prepend="AND" property="fh_lectura_fin">
		  				ad.fh_lectura BETWEEN #fh_lectura_ini# AND #fh_lectura_fin#
                </isNotNull>
            </isNotNull>

            <isNotNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
		  	ad.fh_registro BETWEEN #fh_registro_ini# AND #fh_registro_fin#
                </isNotNull>
                <isNull prepend="AND" property="fh_registro_fin">
		  	ad.fh_registro BETWEEN #fh_registro_ini# AND SYSDATE
                </isNull>
            </isNotNull>
            <isNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
		        ad.fh_registro = #fh_registro_fin#
                </isNotNull>
            </isNull>

            <isNotNull prepend="" property="fh_limite_ini">
                <isNotNull prepend="AND" property="fh_limite_fin">
		  				ad.fh_limite BETWEEN #fh_limite_ini# AND #fh_limite_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="AND" property="fh_limite_ini">
		  				ad.fh_limite = #fh_limite_ini#
            </isNotNull>
            <isNotNull prepend="" property="id_prioridad">
                <isGreaterThan prepend="AND" property="id_prioridad" compareValue="-1">
                    ad.id_prioridad = #id_prioridad#
                </isGreaterThan>
            </isNotNull>

            <isNotNull prepend="" property="id_area_capt">
                <isNotEqual prepend="AND" property="id_area_capt" compareValue="">
		(c.id_area = #id_area_capt# or empleadoRemiAsunto.ID_AREA = #id_area_capt# or empleadoDestAsunto.ID_AREA=#id_area_capt# )
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_capt">
                <isNotEqual prepend="AND" property="nombre_capt" compareValue="">
						c.nombre LIKE '%$nombre_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_capt">
                <isNotEqual prepend="AND" property="paterno_capt" compareValue="">
						c.paterno LIKE '%$paterno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_capt">
                <isNotEqual prepend="AND" property="materno_capt" compareValue="">
						c.materno LIKE '%$materno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_empleado_remi">
                <isNotEqual prepend="AND" property="id_empleado_remi" compareValue="">
						r.id_empleado = #id_empleado_remi#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_area_remi">
                <isNotEqual prepend="AND" property="id_area_remi" compareValue="">
						r.id_area = #id_area_remi#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_remi">
                <isNotEqual prepend="AND" property="nombre_remi" compareValue="">
						r.nombre LIKE '%$nombre_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_remi">
                <isNotEqual prepend="AND" property="paterno_remi" compareValue="">
						r.paterno LIKE '%$paterno_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_remi">
                <isNotEqual prepend="AND" property="materno_remi" compareValue="">
						r.materno LIKE '%$materno_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_empleado_dest">
                <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
						d.id_empleado = #id_empleado_dest#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_area_dest">
                <isNotEqual prepend="AND" property="id_area_dest" compareValue="">
						d.id_area = #id_area_dest#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_dest">
                <isNotEqual prepend="AND" property="nombre_dest" compareValue="">
						d.nombre LIKE '%$nombre_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_dest">
                <isNotEqual prepend="AND" property="paterno_dest" compareValue="">
						d.paterno LIKE '%$paterno_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_dest">
                <isNotEqual prepend="AND" property="materno_dest" compareValue="">
						d.materno LIKE '%$materno_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_tema">
                <isNotEqual prepend="AND" property="id_tema" compareValue="0">
						a.id_tema = #id_tema#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_expediente">
                <isNotEqual prepend="AND" property="id_expediente" compareValue="0">
						a.id_expediente = #id_expediente#
                </isNotEqual>
            </isNotNull>
        </dynamic>
                        order by ad.fh_registro desc
			<!--
                            Orden que traia antes en las bandejas. Comentado por Rodolfo Milano.
                            Se solicito que se ordenara por la fecha de creacin del asunto
			    ORDER BY a.id_asunto DESC -->



    </select>

    <select id="countInicialesByCriterio" parameterClass="mx.gob.economia.scg.model.CriterioAsunto" resultClass="java.lang.Integer">
	SELECT  count(1)
	       FROM asunto a,
               empleado c,
               empleado empleadoRemiAsunto,
               area areaRemiAsunto,
               empleado empleadoDestAsunto,
               area areaDestAsunto,
               area ac,
               asunto_detalle ad,
               empleado d,
               area ar_d,
               empleado r,
               area ar_r,
               empleado i,
               area ar_i,
               expediente e,
               tema t,
               instruccion ins
            where a.id_empleado_capt = c.id_empleado
            and a.ID_EMPLEADO_REMI = empleadoRemiAsunto.id_empleado
            and a.ID_EMPLEADO_DEST = empleadoDestAsunto.id_empleado
            and a.id_asunto = ad.id_asunto
            and a.id_expediente = e.id_expediente(+)
            and a.id_tema = t.id_tema(+)
            and a.id_instruccion = ins.id_instruccion
            and c.id_area = ac.id_area
            and empleadoRemiAsunto.id_area = areaRemiAsunto.id_area
            and empleadoDestAsunto.id_area = areaDestAsunto.id_area
            and ad.id_empleado_remi  = r.id_empleado
            and ad.id_empleado_dest  = d.id_empleado
            and ad.id_empleado_ini = i.id_empleado(+)
            and d.id_area  = ar_d.id_area
            and r.id_area = ar_r.id_area
            and i.id_area = ar_i.id_area(+)
        <dynamic prepend="">

            <isNotNull prepend="" property="estatus">
                <isNotEqual prepend="" property="estatus" compareValue="">
                    <isEqual prepend="AND" property="estatus" compareValue="0">
                                a.estatus = #estatus#
                                and (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) =0
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="1">
                                a.estatus = #estatus#
                                and (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) =0
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="2">
                                a.estatus = #estatus#
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="3">
                                a.estatus = #estatus#
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="7">
                                a.estatus = #estatus#
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="14">
                                (a.estatus = 0 OR a.estatus = 1)
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="4">
							<![CDATA[
						    	(SELECT
								    CASE to_number(to_char(ad3.fh_limite-2,'d'))
								    WHEN 7 THEN ad3.fh_limite-4
								    WHEN 6 THEN ad3.fh_limite-4
								    ELSE ad3.fh_limite-2 END
							    FROM asunto_detalle ad3
							    WHERE ad.id_asunto_detalle = ad3.id_asunto_detalle) > sysdate
							]]>
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="5">
							<![CDATA[
						    	(SELECT
								    CASE to_number(to_char(ad4.fh_limite-2,'d'))
								    WHEN 7 THEN ad4.fh_limite-4
								    WHEN 6 THEN ad4.fh_limite-4
								    ELSE ad4.fh_limite-2 END
							    FROM asunto_detalle ad4
							    WHERE ad.id_asunto_detalle = ad4.id_asunto_detalle) <= sysdate
							    AND ad.fh_limite > to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
							]]>
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="6">
							<![CDATA[
								ad.fh_limite <= to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
							]]>
                    </isEqual>
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="ids_asunto">
                <iterate prepend="AND" property="ids_asunto"
				  		open="(" close=")" conjunction="OR">
				  		a.id_asunto=#ids_asunto[]#
                </iterate>
            </isNotNull>
            <isNotNull prepend="" property="folio">
                <isNotEqual prepend="AND" property="folio" compareValue="">
						a.folio LIKE '$folio$'
                </isNotEqual>
            </isNotNull>

             <!--inicio AGG Filtro por referencia 20111107 -->
            <isNotNull prepend="" property="id_asunto_ref">
                <isNotEqual prepend="AND" property="id_asunto_ref" compareValue="">
						a.id_asunto_ref LIKE upper('%$id_asunto_ref$%')
                </isNotEqual>
            </isNotNull>
            <!--fin AGG Filtro por referencia 20111107 -->

            <isNotNull prepend="" property="id_asunto">
                <isNotEqual prepend="AND" property="id_asunto" compareValue="">
						a.id_asunto = #id_asunto#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="asunto">
                <isNotEqual prepend="AND" property="asunto" compareValue="">
						a.asunto LIKE '%$asunto$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="descripcion">
                <isNotEqual prepend="AND" property="descripcion" compareValue="">
						a.descripcion LIKE '%$descripcion$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="no_oficio">
                <isNotEqual prepend="AND" property="no_oficio" compareValue="">
						a.no_oficio LIKE '%$no_oficio$%'
                </isNotEqual>
            </isNotNull>

            <isNotNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio BETWEEN #fh_oficio_ini# AND #fh_oficio_fin#
                </isNotNull>
                <isNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio BETWEEN #fh_oficio_ini# AND SYSDATE
                </isNull>
            </isNotNull>
            <isNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio = #fh_oficio_fin#
                </isNotNull>
            </isNull>

            <isNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio = #fh_oficio_fin#
                </isNotNull>
            </isNull>

            <isNotNull prepend="" property="fh_recepcion_ini">
                <isNotNull prepend="AND" property="fh_recepcion_fin">
		 				a.fh_recepcion BETWEEN #fh_recepcion_ini# AND #fh_recepcion_fin#
                </isNotNull>
            </isNotNull>

            <isNotNull prepend="" property="fh_lectura_ini">
                <isNotNull prepend="AND" property="fh_lectura_fin">
					ad.fh_lectura BETWEEN #fh_lectura_ini# AND #fh_lectura_fin#
                </isNotNull>
                <isNull prepend="AND" property="fh_lectura_fin">
					ad.fh_lectura BETWEEN #fh_lectura_ini# AND SYSDATE
                </isNull>
            </isNotNull>
            <isNull prepend="" property="fh_lectura_ini">
                <isNotNull prepend="AND" property="fh_lectura_fin">
					ad.fh_lectura = #fh_lectura_fin#
                </isNotNull>
            </isNull>

            <isNotNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
					ad.fh_registro BETWEEN #fh_registro_ini# AND #fh_registro_fin#
            </isNotNull>
                <isNull prepend="AND" property="fh_registro_fin">
					ad.fh_registro BETWEEN #fh_registro_ini# AND SYSDATE
                </isNull>
            </isNotNull>
            <isNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
					ad.fh_registro = #fh_registro_fin#
                </isNotNull>
            </isNull>

            <isNotNull prepend="" property="fh_limite_ini">
                <isNotNull prepend="AND" property="fh_limite_fin">
					ad.fh_limite BETWEEN #fh_limite_ini# AND #fh_limite_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="AND" property="fh_limite_ini">
				ad.fh_limite = #fh_limite_ini#
            </isNotNull>
            <isNotNull prepend="" property="id_prioridad">
                <isGreaterThan prepend="AND" property="id_prioridad" compareValue="-1">
                    ad.id_prioridad = #id_prioridad#
                </isGreaterThan>
            </isNotNull>
            <isNotNull prepend="" property="id_tipo_documento">
                <isGreaterThan prepend="AND" property="id_tipo_documento" compareValue="-1">
                    a.id_tipo_asunto = #id_tipo_documento#
                </isGreaterThan>
            </isNotNull>
            <isNotNull prepend="" property="nombre_capt">
                <isNotEqual prepend="AND" property="nombre_capt" compareValue="">
						c.nombre LIKE '%$nombre_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_capt">
                <isNotEqual prepend="AND" property="paterno_capt" compareValue="">
						c.paterno LIKE '%$paterno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_capt">
                <isNotEqual prepend="AND" property="materno_capt" compareValue="">
						c.materno LIKE '%$materno_capt$%'
                </isNotEqual>
            </isNotNull><isNotNull prepend="" property="id_tema">
                <isNotEqual prepend="AND" property="id_tema" compareValue="-1">
						a.id_tema = #id_tema#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_expediente">
                <isNotEqual prepend="AND" property="id_expediente" compareValue="-1">
						a.id_expediente = #id_expediente#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_evento">
                <isNotEqual prepend="AND" property="id_evento" compareValue="-1">
						a.id_evento = #id_evento#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_area_capt">
                <isNotEqual prepend="AND" property="id_area_capt" compareValue="">
                    (c.id_area = #id_area_capt#
                    or empleadoRemiAsunto.ID_AREA = #id_area_capt#
                    or empleadoDestAsunto.ID_AREA = #id_area_capt#)
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="ids_empleados_ccp">
                <isNotEqual prepend="AND" property="ids_empleados_ccp" compareValue="">
                     (a.id_asunto in (select distinct id_asunto
                                      from asunto_detalle
                                      WHERE id_asunto_detalle IN (SELECT id_asunto_detalle
                                                                  FROM asunto_detalle_ccp
                                                                  WHERE id_empleado in ($ids_empleados_ccp$))
                                         or id_asunto_detalle IN (SELECT id_asunto_detalle
                                                                  FROM ASUNTO_ATT_PARC_CCP_CAPT
                                                                  WHERE id_empleado in ($ids_empleados_ccp$)))
                       or a.id_asunto in (SELECT id_asunto
                                          FROM asunto_ccp
                                          WHERE id_empleado in ($ids_empleados_ccp$)))
                </isNotEqual>
            </isNotNull>

            <isNotNull prepend="" property="confidencial">
                <isEqual prepend="AND" property="confidencial" compareValue="1" >
                                        a.confidencial = 1
                </isEqual>
                <isEqual prepend="AND" property="confidencial" compareValue="0" >
                                        a.confidencial = 0
                </isEqual>
            </isNotNull>
            <isNotNull prepend="" property="enTramite">
                <isEqual prepend="AND" property="enTramite" compareValue="1" >
                            (a.estatus = 0 OR a.estatus = 1)
                            and (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) >0
                </isEqual>
                <!--
                <isEqual prepend="AND" property="enTramite" compareValue="0" >
                                        (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) =0
                </isEqual>
                -->
            </isNotNull>
            <isEqual prepend="" property="busqueda_detalle" compareValue="0">
                and ad.id_asunto_detalle =  (select max(ID_ASUNTO_DETALLE) from asunto_detalle ad2 WHERE ad2.id_asunto = a.id_asunto)
                <isEqual prepend="AND" property="busqueda_modificado" compareValue="1">
                    a.estatus != 3                    
                    and a.id_asunto in (SELECT id_asunto
                                        FROM asunto_captura_actualizacion a
                                        WHERE a.estatus !=7
                                          and a.tipo_actualizacion = 0
                                          and id_empleado_dest = #id_empleado_dest#)
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="1">
                    ar_r.tipo = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="2">
                    ar_r.tipo = 1
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="1">
                    ar_d.tipo = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="2">
                    ar_d.tipo = 1
                </isEqual>

                <isNotNull prepend="" property="id_empleado_remi">
                    <isNotEqual prepend="AND" property="id_empleado_remi" compareValue="">
						a.id_empleado_remi = #id_empleado_remi#
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="id_area_remi">
                    <isNotEqual prepend="AND" property="id_area_remi" compareValue="">
						r.id_area = #id_area_remi#
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="nombre_remi">
                    <isNotEqual prepend="AND" property="nombre_remi" compareValue="">
						r.nombre LIKE '%$nombre_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_remi">
                    <isNotEqual prepend="AND" property="paterno_remi" compareValue="">
						r.paterno LIKE '%$paterno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_remi">
                    <isNotEqual prepend="AND" property="materno_remi" compareValue="">
						r.materno LIKE '%$materno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isEqual prepend="" property="busqueda_modificado" compareValue="0">
                    <isNotNull prepend="" property="id_empleado_dest">
                        <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                                    a.id_empleado_dest = #id_empleado_dest#
                        </isNotEqual>
                    </isNotNull>
                </isEqual>
                <isNotNull prepend="" property="id_area_dest">
                    <isNotEqual prepend="AND" property="id_area_dest" compareValue="">
						d.id_area = #id_area_dest#
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="nombre_dest">
                    <isNotEqual prepend="AND" property="nombre_dest" compareValue="">
						d.nombre LIKE '%$nombre_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_dest">
                    <isNotEqual prepend="AND" property="paterno_dest" compareValue="">
						d.paterno LIKE '%$paterno_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_dest">
                    <isNotEqual prepend="AND" property="materno_dest" compareValue="">
						d.materno LIKE '%$materno_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotEmpty prepend="" property="ids_estatus">
                    <iterate prepend="AND" property="ids_estatus"
                             open="(" close=")" conjunction="OR">
				   a.estatus =#ids_estatus[]#
                    </iterate>
                </isNotEmpty>
            </isEqual>
            <isEqual prepend="" property="busqueda_detalle" compareValue="1">
                <isEmpty prepend="" property="historico">
                    and ad.id_asunto_detalle =  (select max(ID_ASUNTO_DETALLE) from asunto_detalle ad2 WHERE ad2.id_asunto = a.id_asunto)
                </isEmpty>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="1">
                    (select a2.tipo from area a2 where a2.id_area =(select e2.id_area from empleado e2 where e2.id_empleado = ad.id_empleado_remi)) = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="2">
                    (select a2.tipo from area a2 where a2.id_area =(select e2.id_area from empleado e2 where e2.id_empleado = ad.id_empleado_remi)) = 1
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="1">
                    (select a3.tipo from area a3 where a3.id_area =(select e3.id_area from empleado e3 where e3.id_empleado = ad.id_empleado_dest)) = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="2">
                    (select a3.tipo from area a3 where a3.id_area =(select e3.id_area from empleado e3 where e3.id_empleado = ad.id_empleado_dest)) = 1
                </isEqual>
                <isNotEmpty prepend="" property="ids_estatus">
                    <iterate prepend="AND" property="ids_estatus"
                             open="(" close=")" conjunction="OR">
				   ad.estatus =#ids_estatus[]#
                    </iterate>
                </isNotEmpty>

		<isNotNull prepend="" property="id_empleado_recep">
                    <isNotEqual prepend="AND" property="id_empleado_recep" compareValue="">
			     (SELECT ar.id_empleado FROM asunto_recepcion ar where ar.id_asunto = ad.id_asunto and ar.id_asunto_detalle = ad.id_asunto_detalle and ar.id_empleado = #id_empleado_recep#) = #id_empleado_recep#
			</isNotEqual>
		</isNotNull>

                <isNotNull prepend="" property="id_empleado_remi">
                    <isNotEqual prepend="" property="id_empleado_remi" compareValue="">
                        <isNotNull prepend="" property="id_empleado_dest">
                            <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                (ad.id_empleado_remi = #id_empleado_remi#
                                 or ad.id_empleado_dest = #id_empleado_dest#)
                            </isNotEqual>
                        </isNotNull>
                        <isEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                ad.id_empleado_remi = #id_empleado_remi#
                        </isEqual>
                    </isNotEqual>
                </isNotNull>
                <isEqual prepend="" property="id_empleado_remi" compareValue="">
                    <isNotNull prepend="" property="id_empleado_dest">
                            <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                ad.id_empleado_dest = #id_empleado_dest#
                            </isNotEqual>
                    </isNotNull>
                </isEqual>

                <isNotNull prepend="" property="id_area_remi">
                    <isNotEqual prepend="AND" property="id_area_remi" compareValue="">
						(select erd.id_area from empleado erd where erd.id_empleado = ad.id_empleado_remi) = #id_area_remi#
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="nombre_remi">
                    <isNotEqual prepend="AND" property="nombre_remi" compareValue="">
						(select erd.nombre from empleado erd where erd.id_empleado = ad.id_empleado_remi) LIKE '%$nombre_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_remi">
                    <isNotEqual prepend="AND" property="paterno_remi" compareValue="">
						(select erd.paterno from empleado erd where erd.id_empleado = ad.id_empleado_remi) LIKE '%$paterno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_remi">
                    <isNotEqual prepend="AND" property="materno_remi" compareValue="">
						(select erd.materno from empleado erd where erd.id_empleado = ad.id_empleado_remi) LIKE '%$materno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="id_area_dest">
                    <isNotEqual prepend="AND" property="id_area_dest" compareValue="">
						(select erd.id_area from empleado erd where erd.id_empleado = ad.id_empleado_dest) = #id_area_dest#
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="nombre_dest">
                    <isNotEqual prepend="AND" property="nombre_dest" compareValue="">
						(select erd.nombre from empleado erd where erd.id_empleado = ad.id_empleado_dest) LIKE '%$nombre_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_dest">
                    <isNotEqual prepend="AND" property="paterno_dest" compareValue="">
						(select erd.paterno from empleado erd where erd.id_empleado = ad.id_empleado_dest) LIKE '%$paterno_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_dest">
                    <isNotEqual prepend="AND" property="materno_dest" compareValue="">
						(select erd.materno from empleado erd where erd.id_empleado = ad.id_empleado_dest) LIKE '%$materno_dest$%'
                    </isNotEqual>
                </isNotNull>
            </isEqual>

        </dynamic>
    </select>




    <select id="listActualesByCriterio" parameterClass="mx.gob.economia.scg.model.CriterioAsunto" resultMap="asuntoDetalleMap">
		SELECT * FROM (
		SELECT vista.*, rownum r FROM(
			SELECT a.folio, a.folio || '-' || a.contador_folio contador_folio,
	            a.id_asunto, a.asunto, a.descripcion, a.no_oficio, a.fh_oficio, a.fh_recepcion, a.id_empleado_capt,
	            CASE to_number(to_char(ad.fh_limite-2,'d'))
	            WHEN 7 THEN ad.fh_limite-4
	            WHEN 6 THEN ad.fh_limite-4
	            ELSE ad.fh_limite-2 END AS fh_por_vencer, ad.estatus,
	            c.correo AS correo_capt, c.nombre AS nombre_capt,
	            c.paterno AS paterno_capt, c.materno AS materno_capt,
	            c.id_area AS id_area_capt, ac.area AS area_capt, c.activo AS activo_capt, c.puesto AS puesto_capt,
	            ad.id_asunto_detalle, ad.fh_lectura, ad.fh_registro, ad.fh_limite, ad.comentario, ad.ip,
	            r.id_empleado AS id_empleado_remi, r.correo AS correo_remi, r.nombre AS nombre_remi,
	            r.paterno AS paterno_remi, r.materno AS materno_remi,
	            r.id_area AS id_area_remi, ar_r.area AS area_remi, r.activo AS activo_remi, r.puesto AS puesto_remi,
	            d.id_empleado AS id_empleado_dest, d.correo AS correo_dest, d.nombre AS nombre_dest,
	            d.paterno AS paterno_dest, d.materno AS materno_dest,
	            d.id_area AS id_area_dest, ar_d.area AS area_dest, d.activo AS activo_dest, d.puesto AS puesto_dest,
	            i.id_empleado AS id_empleado_ini, i.correo AS correo_ini, i.nombre AS nombre_ini,
	            i.paterno AS paterno_ini, i.materno AS materno_ini,
	            i.id_area AS id_area_ini, ar_i.area AS area_ini, i.activo AS activo_ini, i.puesto AS puesto_ini, a.id_asunto_padre,
	            a.id_expediente, e.expediente, a.id_tema, t.id_tema_padre, t.tema, t.evento tema_evento, a.fh_evento,
	            a.id_instruccion, ins.instruccion, a.id_tipo_asunto, ad.id_prioridad, a.confidencial
	        FROM asunto a
	        LEFT JOIN empleado c ON c.id_empleado = a.id_empleado_capt
	        LEFT JOIN area ac ON ac.id_area = c.id_area
	        LEFT JOIN asunto_detalle ad ON a.id_asunto = ad.id_asunto
	        LEFT JOIN empleado d ON d.id_empleado = ad.id_empleado_dest
	        LEFT JOIN area ar_d ON ar_d.id_area = d.id_area
	        LEFT JOIN empleado r ON r.id_empleado = ad.id_empleado_remi
	        LEFT JOIN area ar_r ON ar_r.id_area = r.id_area
	        LEFT JOIN empleado i ON i.id_empleado = ad.id_empleado_ini
	        LEFT JOIN area ar_i ON ar_i.id_area = i.id_area
	        LEFT JOIN expediente e ON e.id_expediente = a.id_expediente
                LEFT JOIN tema t ON t.id_tema = a.id_tema
		LEFT JOIN instruccion ins ON ins.id_instruccion = a.id_instruccion
                LEFT JOIN evento ev ON ev.id_evento = a.id_evento
        <dynamic prepend="">
            <isNotEqual prepend="" property="id_empleado_ccp" compareValue="">
	        		INNER JOIN asunto_ccp ccp ON ccp.ID_ASUNTO= a.ID_ASUNTO AND ccp.ID_EMPLEADO = #id_empleado_ccp#
            </isNotEqual>
        </dynamic>
        <dynamic prepend="">
            <isNotEqual prepend="" property="id_empleado_recep" compareValue="">
                        LEFT OUTER JOIN asunto_recepcion ar ON ar.id_asunto = a.id_asunto
                        AND ad.id_asunto_detalle = ar.id_asunto_detalle AND ar.ID_EMPLEADO = #id_empleado_recep#
            </isNotEqual>
        </dynamic>
			WHERE ad.id_asunto_detalle =
<!--			<dynamic prepend="">-->
<!--	        	<isEqual prepend="" property="estatus" compareValue="1">-->
<!--					(SELECT c_ad2.id_asunto_detalle FROM concentrado_asunto_det c_ad2 -->
<!--						LEFT JOIN asunto_detalle ad2 ON c_ad2.id_asunto_detalle = ad2.id_asunto_detalle AND ad2.id_empleado_dest = #id_empleado_dest#-->
<!--						WHERE ad2.id_asunto = a.id_asunto AND c_ad2.estatus = 1)-->
<!--				</isEqual>-->
<!--				<isNotEqual prepend="" property="estatus" compareValue="1">-->
					(SELECT MAX(ad2.id_asunto_detalle) FROM asunto_detalle ad2 WHERE ad2.id_asunto = a.id_asunto)
<!--				</isNotEqual>-->
<!--			</dynamic>	-->
        <dynamic prepend="">
            <isNotEmpty prepend="" property="ids_estatus">
                <iterate prepend="AND" property="ids_estatus"
			  			open="(" close=")" conjunction="OR">
							ad.estatus =#ids_estatus[]#
                </iterate>
            </isNotEmpty>
            <isNotEmpty prepend="" property="ids_empleados_dest">
                <iterate prepend="AND" property="ids_empleados_dest"
		  			open="(" close=")" conjunction="OR">
						ad.id_empleado_dest =#ids_empleados_dest[]#
                </iterate>
            </isNotEmpty>
            <isNotNull prepend="" property="estatus">
                <isNotEqual prepend="AND" property="estatus" compareValue="">
                    <isLessEqual prepend="" property="estatus" compareValue="3">
							ad.estatus = #estatus#
                    </isLessEqual>
                    <isEqual prepend="" property="estatus" compareValue="4">
							<![CDATA[
						    	(SELECT
								    CASE to_number(to_char(ad3.fh_limite-2,'d'))
								    WHEN 7 THEN ad3.fh_limite-4
								    WHEN 6 THEN ad3.fh_limite-4
								    ELSE ad3.fh_limite-2 END
							    FROM asunto_detalle ad3
							    WHERE ad.id_asunto_detalle = ad3.id_asunto_detalle) > sysdate
							]]>
                    </isEqual>
                    <isEqual prepend="" property="estatus" compareValue="5">
							<![CDATA[
						    	(SELECT
								    CASE to_number(to_char(ad4.fh_limite-2,'d'))
								    WHEN 7 THEN ad4.fh_limite-4
								    WHEN 6 THEN ad4.fh_limite-4
								    ELSE ad4.fh_limite-2 END
							    FROM asunto_detalle ad4
							    WHERE ad.id_asunto_detalle = ad4.id_asunto_detalle) <= sysdate
							    AND ad.fh_limite > to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
							]]>
                    </isEqual>
                    <isEqual prepend="" property="estatus" compareValue="6">
							<![CDATA[
								ad.fh_limite <= to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
							]]>
                    </isEqual>
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="ids_asunto">
                <iterate prepend="AND" property="ids_asunto"
				  		open="(" close=")" conjunction="OR">
				  		a.id_asunto=#ids_asunto[]#
                </iterate>
            </isNotNull>
            <isNotNull prepend="" property="id_asunto">
                <isNotEqual prepend="AND" property="id_asunto" compareValue="">
						a.id_asunto = #id_asunto#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="folio">
                <isNotEqual prepend="AND" property="folio" compareValue="">
                                              a.folio  LIKE '%$folio$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="asunto">
                <isNotEqual prepend="AND" property="asunto" compareValue="">
						a.asunto LIKE '%$asunto$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="descripcion">
                <isNotEqual prepend="AND" property="descripcion" compareValue="">
						a.descripcion LIKE '%$descripcion$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="no_oficio">
                <isNotEqual prepend="AND" property="no_oficio" compareValue="">
						a.no_oficio LIKE '%$no_oficio$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
		 				a.fh_oficio BETWEEN #fh_oficio_ini# AND #fh_oficio_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_recepcion_ini">
                <isNotNull prepend="AND" property="fh_recepcion_fin">
		 				a.fh_recepcion BETWEEN #fh_recepcion_ini# AND #fh_recepcion_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_lectura_ini">
                <isNotNull prepend="AND" property="fh_lectura_fin">
		  				ad.fh_lectura BETWEEN #fh_lectura_ini# AND #fh_lectura_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
		  				ad.fh_registro BETWEEN #fh_registro_ini# AND #fh_registro_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_limite_ini">
                <isNotNull prepend="AND" property="fh_limite_fin">
		  				ad.fh_limite BETWEEN #fh_limite_ini# AND #fh_limite_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="id_area_capt">
                <isNotEqual prepend="AND" property="id_area_capt" compareValue="">
						c.id_area = #id_area_capt#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_capt">
                <isNotEqual prepend="AND" property="nombre_capt" compareValue="">
						c.nombre LIKE '%$nombre_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_capt">
                <isNotEqual prepend="AND" property="paterno_capt" compareValue="">
						c.paterno LIKE '%$paterno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_capt">
                <isNotEqual prepend="AND" property="materno_capt" compareValue="">
						c.materno LIKE '%$materno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_empleado_remi">
                <isNotEqual prepend="AND" property="id_empleado_remi" compareValue="">
						r.id_empleado = #id_empleado_remi#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_area_remi">
                <isNotEqual prepend="AND" property="id_area_remi" compareValue="">
						r.id_area = #id_area_remi#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_remi">
                <isNotEqual prepend="OR" property="nombre_remi" compareValue="">
						r.nombre LIKE '%$nombre_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_remi">
                <isNotEqual prepend="OR" property="paterno_remi" compareValue="">
						r.paterno LIKE '%$paterno_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_remi">
                <isNotEqual prepend="OR" property="materno_remi" compareValue="">
						r.materno LIKE '%$materno_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_empleado_dest">
                <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
						a.id_empleado_dest = #id_empleado_dest#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_area_dest">
                <isNotEqual prepend="AND" property="id_area_dest" compareValue="">
						d.id_area = #id_area_dest#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_dest">
                <isNotEqual prepend="AND" property="nombre_dest" compareValue="">
						d.nombre LIKE '%$nombre_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_dest">
                <isNotEqual prepend="AND" property="paterno_dest" compareValue="">
						d.paterno LIKE '%$paterno_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_dest">
                <isNotEqual prepend="AND" property="materno_dest" compareValue="">
						d.materno LIKE '%$materno_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_tema">
                <isNotEqual prepend="AND" property="id_tema" compareValue="-1">
						a.id_tema = #id_tema#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_expediente">
                <isNotEqual prepend="AND" property="id_expediente" compareValue="-1">
						a.id_expediente = #id_expediente#
                </isNotEqual>
            </isNotNull>
        </dynamic>
			
                        order by ad.fh_registro desc
			<!--
                            Orden que traia antes en las bandejas. Comentado por Rodolfo Milano.
                            Se solicito que se ordenara por la fecha de creacin del asunto
			    ORDER BY ORDER BY contador_folio asc -->


                ) vista WHERE ROWNUM<![CDATA[ <= ]]>#paginador.maximo#
	    ) WHERE r<![CDATA[ >= ]]>#paginador.minimo#
    </select>

    <select id="listActualesByCriterioDetallePDF" parameterClass="mx.gob.economia.scg.model.CriterioAsunto" resultMap="asuntoDetalleMap">
		SELECT * FROM (
		SELECT vista.*, rownum r FROM(
			SELECT a.folio, a.folio || '-' || a.contador_folio contador_folio,
	            a.id_asunto, a.asunto, a.descripcion, a.no_oficio, a.fh_oficio, a.fh_recepcion, a.id_empleado_capt,
	            CASE to_number(to_char(ad.fh_limite-2,'d'))
	            WHEN 7 THEN ad.fh_limite-4
	            WHEN 6 THEN ad.fh_limite-4
	            ELSE ad.fh_limite-2 END AS fh_por_vencer, ad.estatus,
	            c.correo AS correo_capt, c.nombre AS nombre_capt,
	            c.paterno AS paterno_capt, c.materno AS materno_capt,
	            c.id_area AS id_area_capt, ac.area AS area_capt, c.activo AS activo_capt, c.puesto AS puesto_capt,
	            ad.id_asunto_detalle, ad.fh_lectura, ad.fh_registro, ad.fh_limite, ad.comentario, ad.ip,
	            r.id_empleado AS id_empleado_remi, r.correo AS correo_remi, r.nombre AS nombre_remi,
	            r.paterno AS paterno_remi, r.materno AS materno_remi,
	            r.id_area AS id_area_remi, ar_r.area AS area_remi, r.activo AS activo_remi, r.puesto AS puesto_remi,
	            d.id_empleado AS id_empleado_dest, d.correo AS correo_dest, d.nombre AS nombre_dest,
	            d.paterno AS paterno_dest, d.materno AS materno_dest,
	            d.id_area AS id_area_dest, ar_d.area AS area_dest, d.activo AS activo_dest, d.puesto AS puesto_dest,
	            i.id_empleado AS id_empleado_ini, i.correo AS correo_ini, i.nombre AS nombre_ini,
	            i.paterno AS paterno_ini, i.materno AS materno_ini,
	            i.id_area AS id_area_ini, ar_i.area AS area_ini, i.activo AS activo_ini, i.puesto AS puesto_ini, a.id_asunto_padre,
	            a.id_expediente, e.expediente, a.id_tema, t.id_tema_padre, t.tema, t.evento tema_evento, a.fh_evento,
	            a.id_instruccion, ins.instruccion, a.id_tipo_asunto, ad.id_prioridad, a.confidencial
	        FROM asunto a
	        LEFT JOIN empleado c ON c.id_empleado = a.id_empleado_capt
	        LEFT JOIN area ac ON ac.id_area = c.id_area
	        LEFT JOIN asunto_detalle ad ON a.id_asunto = ad.id_asunto
	        LEFT JOIN empleado d ON d.id_empleado = ad.id_empleado_dest
	        LEFT JOIN area ar_d ON ar_d.id_area = d.id_area
	        LEFT JOIN empleado r ON r.id_empleado = ad.id_empleado_remi
	        LEFT JOIN area ar_r ON ar_r.id_area = r.id_area
	        LEFT JOIN empleado i ON i.id_empleado = ad.id_empleado_ini
	        LEFT JOIN area ar_i ON ar_i.id_area = i.id_area
	        LEFT JOIN expediente e ON e.id_expediente = a.id_expediente
                LEFT JOIN tema t ON t.id_tema = a.id_tema
		LEFT JOIN instruccion ins ON ins.id_instruccion = a.id_instruccion
                LEFT JOIN evento ev ON ev.id_evento = a.id_evento
        <dynamic prepend="">
            <isNotEqual prepend="" property="id_empleado_ccp" compareValue="">
	        		INNER JOIN asunto_ccp ccp ON ccp.ID_ASUNTO= a.ID_ASUNTO AND ccp.ID_EMPLEADO = #id_empleado_ccp#
            </isNotEqual>
        </dynamic>
        <dynamic prepend="">
            <isNotEqual prepend="" property="id_empleado_recep" compareValue="">
                        LEFT OUTER JOIN asunto_recepcion ar ON ar.id_asunto = a.id_asunto
                        AND ad.id_asunto_detalle = ar.id_asunto_detalle AND ar.ID_EMPLEADO = #id_empleado_recep#
            </isNotEqual>
        </dynamic>
			WHERE ad.id_asunto_detalle =
<!--			<dynamic prepend="">-->
<!--	        	<isEqual prepend="" property="estatus" compareValue="1">-->
<!--					(SELECT c_ad2.id_asunto_detalle FROM concentrado_asunto_det c_ad2 -->
<!--						LEFT JOIN asunto_detalle ad2 ON c_ad2.id_asunto_detalle = ad2.id_asunto_detalle AND ad2.id_empleado_dest = #id_empleado_dest#-->
<!--						WHERE ad2.id_asunto = a.id_asunto AND c_ad2.estatus = 1)-->
<!--				</isEqual>-->
<!--				<isNotEqual prepend="" property="estatus" compareValue="1">-->
					(SELECT MAX(ad2.id_asunto_detalle) FROM asunto_detalle ad2 WHERE ad2.id_asunto = a.id_asunto)
<!--				</isNotEqual>-->
<!--			</dynamic>	-->
        <dynamic prepend="">
            <isNotEmpty prepend="" property="ids_estatus">
                <iterate prepend="AND" property="ids_estatus"
			  			open="(" close=")" conjunction="OR">
							ad.estatus =#ids_estatus[]#
                </iterate>
            </isNotEmpty>
            <isNotEmpty prepend="" property="ids_empleados_dest">
                <iterate prepend="AND" property="ids_empleados_dest"
		  			open="(" close=")" conjunction="OR">
						ad.id_empleado_dest =#ids_empleados_dest[]#
                </iterate>
            </isNotEmpty>
            <isNotNull prepend="" property="estatus">
                <isNotEqual prepend="AND" property="estatus" compareValue="">
                    <isLessEqual prepend="" property="estatus" compareValue="3">
							ad.estatus = #estatus#
                    </isLessEqual>
                    <isEqual prepend="" property="estatus" compareValue="4">
							<![CDATA[
						    	(SELECT
								    CASE to_number(to_char(ad3.fh_limite-2,'d'))
								    WHEN 7 THEN ad3.fh_limite-4
								    WHEN 6 THEN ad3.fh_limite-4
								    ELSE ad3.fh_limite-2 END
							    FROM asunto_detalle ad3
							    WHERE ad.id_asunto_detalle = ad3.id_asunto_detalle) > sysdate
							]]>
                    </isEqual>
                    <isEqual prepend="" property="estatus" compareValue="5">
							<![CDATA[
						    	(SELECT
								    CASE to_number(to_char(ad4.fh_limite-2,'d'))
								    WHEN 7 THEN ad4.fh_limite-4
								    WHEN 6 THEN ad4.fh_limite-4
								    ELSE ad4.fh_limite-2 END
							    FROM asunto_detalle ad4
							    WHERE ad.id_asunto_detalle = ad4.id_asunto_detalle) <= sysdate
							    AND ad.fh_limite > to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
							]]>
                    </isEqual>
                    <isEqual prepend="" property="estatus" compareValue="6">
							<![CDATA[
								ad.fh_limite <= to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
							]]>
                    </isEqual>
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="ids_asunto">
                <iterate prepend="AND" property="ids_asunto"
				  		open="(" close=")" conjunction="OR">
				  		a.id_asunto=#ids_asunto[]#
                </iterate>
            </isNotNull>
            <isNotNull prepend="" property="id_asunto">
                <isNotEqual prepend="AND" property="id_asunto" compareValue="">
						a.id_asunto = #id_asunto#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="folio">
                <isNotEqual prepend="AND" property="folio" compareValue="">
                                              a.folio  LIKE '%$folio$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="asunto">
                <isNotEqual prepend="AND" property="asunto" compareValue="">
						a.asunto LIKE '%$asunto$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="descripcion">
                <isNotEqual prepend="AND" property="descripcion" compareValue="">
						a.descripcion LIKE '%$descripcion$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="no_oficio">
                <isNotEqual prepend="AND" property="no_oficio" compareValue="">
						a.no_oficio LIKE '%$no_oficio$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
		 				a.fh_oficio BETWEEN #fh_oficio_ini# AND #fh_oficio_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_recepcion_ini">
                <isNotNull prepend="AND" property="fh_recepcion_fin">
		 				a.fh_recepcion BETWEEN #fh_recepcion_ini# AND #fh_recepcion_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_lectura_ini">
                <isNotNull prepend="AND" property="fh_lectura_fin">
		  				ad.fh_lectura BETWEEN #fh_lectura_ini# AND #fh_lectura_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
		  				ad.fh_registro BETWEEN #fh_registro_ini# AND #fh_registro_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_limite_ini">
                <isNotNull prepend="AND" property="fh_limite_fin">
		  				ad.fh_limite BETWEEN #fh_limite_ini# AND #fh_limite_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="id_area_capt">
                <isNotEqual prepend="AND" property="id_area_capt" compareValue="">
						c.id_area = #id_area_capt#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_capt">
                <isNotEqual prepend="AND" property="nombre_capt" compareValue="">
						c.nombre LIKE '%$nombre_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_capt">
                <isNotEqual prepend="AND" property="paterno_capt" compareValue="">
						c.paterno LIKE '%$paterno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_capt">
                <isNotEqual prepend="AND" property="materno_capt" compareValue="">
						c.materno LIKE '%$materno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_empleado_remi">
                <isNotEqual prepend="AND" property="id_empleado_remi" compareValue="">
						r.id_empleado = #id_empleado_remi#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_area_remi">
                <isNotEqual prepend="AND" property="id_area_remi" compareValue="">
						r.id_area = #id_area_remi#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_remi">
                <isNotEqual prepend="OR" property="nombre_remi" compareValue="">
						r.nombre LIKE '%$nombre_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_remi">
                <isNotEqual prepend="OR" property="paterno_remi" compareValue="">
						r.paterno LIKE '%$paterno_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_remi">
                <isNotEqual prepend="OR" property="materno_remi" compareValue="">
						r.materno LIKE '%$materno_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_empleado_dest">
                <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
						a.id_empleado_dest = #id_empleado_dest#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_area_dest">
                <isNotEqual prepend="AND" property="id_area_dest" compareValue="">
						d.id_area = #id_area_dest#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_dest">
                <isNotEqual prepend="AND" property="nombre_dest" compareValue="">
						d.nombre LIKE '%$nombre_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_dest">
                <isNotEqual prepend="AND" property="paterno_dest" compareValue="">
						d.paterno LIKE '%$paterno_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_dest">
                <isNotEqual prepend="AND" property="materno_dest" compareValue="">
						d.materno LIKE '%$materno_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_tema">
                <isNotEqual prepend="AND" property="id_tema" compareValue="-1">
						a.id_tema = #id_tema#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_expediente">
                <isNotEqual prepend="AND" property="id_expediente" compareValue="-1">
						a.id_expediente = #id_expediente#
                </isNotEqual>
            </isNotNull>
        </dynamic>

                        order by ad.fh_registro desc
			<!--
                            Orden que traia antes en las bandejas. Comentado por Rodolfo Milano.
                            Se solicito que se ordenara por la fecha de creacin del asunto
			    ORDER BY ORDER BY contador_folio asc -->


                ) vista WHERE ROWNUM<![CDATA[ <= ]]>#paginador.maximo#
	    ) WHERE r<![CDATA[ >= ]]>#paginador.minimo#
    </select>

    <select id="countActualesByCriterio" parameterClass="mx.gob.economia.scg.model.CriterioAsunto" resultClass="java.lang.Integer">
		SELECT
            COUNT(1)

        FROM asunto a
        LEFT JOIN empleado c ON c.id_empleado = a.id_empleado_capt
        LEFT JOIN area ac ON ac.id_area = c.id_area
        LEFT JOIN asunto_detalle ad ON a.id_asunto = ad.id_asunto
        LEFT JOIN empleado d ON d.id_empleado = ad.id_empleado_dest
        LEFT JOIN area ar_d ON ar_d.id_area = d.id_area
        LEFT JOIN empleado r ON r.id_empleado = ad.id_empleado_remi
        LEFT JOIN area ar_r ON ar_r.id_area = r.id_area
        LEFT JOIN empleado i ON i.id_empleado = ad.id_empleado_ini
        LEFT JOIN area ar_i ON ar_i.id_area = i.id_area
        LEFT JOIN expediente e ON e.id_expediente = a.id_expediente
        LEFT JOIN tema t ON t.id_tema = a.id_tema
        LEFT JOIN instruccion ins ON ins.id_instruccion = a.id_instruccion


        <dynamic prepend="">
            <isNotEqual prepend="" property="id_empleado_ccp" compareValue="">
        		INNER JOIN asunto_ccp ccp ON ccp.ID_ASUNTO= a.ID_ASUNTO AND ccp.ID_EMPLEADO = #id_empleado_ccp#
            </isNotEqual>
        </dynamic>
        <dynamic prepend="">
            <isNotEqual prepend="" property="id_empleado_recep" compareValue="">
                        LEFT OUTER JOIN asunto_recepcion ar ON ar.id_asunto = a.id_asunto
                        AND ad.id_asunto_detalle = ar.id_asunto_detalle AND ar.ID_EMPLEADO = #id_empleado_recep#
            </isNotEqual>
        </dynamic>
        WHERE ad.id_asunto_detalle =
<!--        <dynamic prepend="">-->
<!--        	<isEqual prepend="" property="estatus" compareValue="1">-->
<!--				(SELECT c_ad2.id_asunto_detalle FROM concentrado_asunto_det c_ad2 -->
<!--					LEFT JOIN asunto_detalle ad2 ON c_ad2.id_asunto_detalle = ad2.id_asunto_detalle AND ad2.id_empleado_dest = #id_empleado_dest#-->
<!--					WHERE ad2.id_asunto = a.id_asunto AND c_ad2.estatus = 1)-->
<!--			</isEqual>-->
<!--			<isNotEqual prepend="" property="estatus" compareValue="1">-->
				(SELECT MAX(ad2.id_asunto_detalle) FROM asunto_detalle ad2 WHERE ad2.id_asunto = a.id_asunto)
<!--			</isNotEqual>-->
<!--		</dynamic>	-->
        <dynamic prepend="">
            <isNotEmpty prepend="" property="ids_estatus">
                <iterate prepend="AND" property="ids_estatus"
		  			open="(" close=")" conjunction="OR">
						ad.estatus =#ids_estatus[]#
                </iterate>
            </isNotEmpty>
            <isNotEmpty prepend="" property="ids_empleados_dest">
                <iterate prepend="AND" property="ids_empleados_dest"
		  			open="(" close=")" conjunction="OR">
						ad.id_empleado_dest =#ids_empleados_dest[]#
                </iterate>
            </isNotEmpty>
            <isNotNull prepend="" property="estatus">
                <isNotEqual prepend="AND" property="estatus" compareValue="">
                    <isLessEqual prepend="" property="estatus" compareValue="3">
						ad.estatus = #estatus#
                    </isLessEqual>
                    <isEqual prepend="" property="estatus" compareValue="4">
						<![CDATA[
					    	(SELECT
							    CASE to_number(to_char(ad3.fh_limite-2,'d'))
							    WHEN 7 THEN ad3.fh_limite-4
							    WHEN 6 THEN ad3.fh_limite-4
							    ELSE ad3.fh_limite-2 END
						    FROM asunto_detalle ad3
						    WHERE ad.id_asunto_detalle = ad3.id_asunto_detalle) > sysdate
						]]>
                    </isEqual>
                    <isEqual prepend="" property="estatus" compareValue="5">
						<![CDATA[
					    	(SELECT
							    CASE to_number(to_char(ad4.fh_limite-2,'d'))
							    WHEN 7 THEN ad4.fh_limite-4
							    WHEN 6 THEN ad4.fh_limite-4
							    ELSE ad4.fh_limite-2 END
						    FROM asunto_detalle ad4
						    WHERE ad.id_asunto_detalle = ad4.id_asunto_detalle) <= sysdate
						    AND ad.fh_limite > to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
						]]>
                    </isEqual>
                    <isEqual prepend="" property="estatus" compareValue="6">
						<![CDATA[
							ad.fh_limite <= to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY')
						]]>
                    </isEqual>
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="ids_asunto">
                <iterate prepend="AND" property="ids_asunto"
			  		open="(" close=")" conjunction="OR">
			  		a.id_asunto=#ids_asunto[]#
                </iterate>
            </isNotNull>
            <isNotNull prepend="" property="id_asunto">
                <isNotEqual prepend="AND" property="id_asunto" compareValue="">
					a.id_asunto = #id_asunto#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="folio">
                <isNotEqual prepend="AND" property="folio" compareValue="">
                                                a.folio LIKE '$folio$'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="asunto">
                <isNotEqual prepend="AND" property="asunto" compareValue="">
					a.asunto LIKE '%$asunto$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="descripcion">
                <isNotEqual prepend="AND" property="descripcion" compareValue="">
					a.descripcion LIKE '%$descripcion$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="no_oficio">
                <isNotEqual prepend="AND" property="no_oficio" compareValue="">
					a.no_oficio LIKE '%$no_oficio$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
	 				a.fh_oficio BETWEEN #fh_oficio_ini# AND #fh_oficio_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_recepcion_ini">
                <isNotNull prepend="AND" property="fh_recepcion_fin">
		 				a.fh_recepcion BETWEEN #fh_recepcion_ini# AND #fh_recepcion_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_lectura_ini">
                <isNotNull prepend="AND" property="fh_lectura_fin">
	  				ad.fh_lectura BETWEEN #fh_lectura_ini# AND #fh_lectura_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
	  				ad.fh_registro BETWEEN #fh_registro_ini# AND #fh_registro_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="fh_registro">
	  				ad.fh_registro BETWEEN #fh_registro_ini# AND #fh_registro_fin#
            </isNotNull>
            <isNotNull prepend="" property="fh_limite_ini">
                <isNotNull prepend="AND" property="fh_limite_fin">
	  				ad.fh_limite BETWEEN #fh_limite_ini# AND #fh_limite_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="id_area_capt">
                <isNotEqual prepend="AND" property="id_area_capt" compareValue="">
					c.id_area = #id_area_capt#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_capt">
                <isNotEqual prepend="AND" property="nombre_capt" compareValue="">
					c.nombre LIKE '%$nombre_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_capt">
                <isNotEqual prepend="AND" property="paterno_capt" compareValue="">
					c.paterno LIKE '%$paterno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_capt">
                <isNotEqual prepend="AND" property="materno_capt" compareValue="">
					c.materno LIKE '%$materno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_empleado_remi">
                <isNotEqual prepend="AND" property="id_empleado_remi" compareValue="">
					r.id_empleado = #id_empleado_remi#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_area_remi">
                <isNotEqual prepend="AND" property="id_area_remi" compareValue="">
					r.id_area = #id_area_remi#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_remi">
                <isNotEqual prepend="OR" property="nombre_remi" compareValue="">
					r.nombre LIKE '%$nombre_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_remi">
                <isNotEqual prepend="OR" property="paterno_remi" compareValue="">
					r.paterno LIKE '%$paterno_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_remi">
                <isNotEqual prepend="OR" property="materno_remi" compareValue="">
					r.materno LIKE '%$materno_remi$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_empleado_dest">
                <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
					d.id_empleado = #id_empleado_dest#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_area_dest">
                <isNotEqual prepend="AND" property="id_area_dest" compareValue="">
					d.id_area = #id_area_dest#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="nombre_dest">
                <isNotEqual prepend="OR" property="nombre_dest" compareValue="">
					d.nombre LIKE '%$nombre_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_dest">
                <isNotEqual prepend="OR" property="paterno_dest" compareValue="">
					d.paterno LIKE '%$paterno_dest$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_dest">
                <isNotEqual prepend="OR" property="materno_dest" compareValue="">
					d.materno LIKE '%$materno_dest$%'
                </isNotEqual>
            </isNotNull>
        </dynamic>
        AND ROWNUM <![CDATA[ <= ]]>#paginador.numMaxRegistros#
    </select>

    <insert id="insert" parameterClass="mx.gob.economia.scg.model.Asunto">
        <selectKey keyProperty="id_asunto" resultClass="int">
			SELECT seq_asunto.nextval FROM dual
        </selectKey>
		INSERT INTO asunto(id_asunto, asunto, descripcion, no_oficio, fh_oficio, fh_recepcion, id_empleado_capt,
                id_empleado_remi, id_empleado_dest, estatus, id_asunto_ref, folio, contador_folio, id_asunto_padre, id_expediente,
                id_instruccion,id_tema, fh_evento,id_tipo_asunto,confidencial,antecedente,id_evento)
		VALUES (#id_asunto#, #asunto#, #descripcion#,#no_oficio#, #fh_oficio#, #fh_recepcion#, #empleado_capt.id_empleado#,
                #asunto_detalle.empleado_remi.id_empleado#, #asunto_detalle.empleado_dest.id_empleado#, #estatus#,
                #id_asunto_ref#,#folio#,
                (select lpad(count(*) + 1,2,'0') from asunto where folio=#folio#),
                #id_asunto_padre#, #expediente.id_expediente#, #id_instruccion#, #tema.id_tema#,
                #fh_evento#, #tipoAsunto.id_tipo_documento#,#confidencial#,#antecedente#,#evento.id_evento#)
    </insert>
    <update id="updateCaptura" parameterClass="mx.gob.economia.scg.model.Asunto">
		UPDATE asunto SET
			asunto=#asunto#,
			descripcion=#descripcion#,
			no_oficio=#no_oficio#,
			fh_oficio=#fh_oficio#,
			fh_recepcion=#fh_recepcion#,
			id_empleado_remi=#asunto_detalle.empleado_remi.id_empleado#,
			id_empleado_dest=#asunto_detalle.empleado_dest.id_empleado#,
			estatus=#estatus#,
			id_asunto_ref=#id_asunto_ref#,
			id_asunto_padre=#id_asunto_padre#,
			id_expediente=#expediente.id_expediente#,
			id_tema=#tema.id_tema#,
			fh_evento=#fh_evento#,
			id_tipo_asunto=#tipoAsunto.id_tipo_documento#,
                        confidencial=#confidencial#,
                        antecedente=#antecedente#,
                        id_evento=#evento.id_evento#
		WHERE id_asunto=#id_asunto#
    </update>


    <insert id="insertConsecutivoAsuntoArea" parameterClass="mx.gob.economia.scg.model.Asunto">
        INSERT INTO asunto_consecutivo_area (id_asunto, id_area, consecutivo, folio)
        values(#id_asunto#,#empleado_capt.area.id_area#,
        (select case
            when (cast((SELECT TO_CHAR(TRUNC(SYSDATE, 'YEAR'), 'YYYY') year FROM dual) as integer)) >
            (select cast( to_char(TRUNC( max(marca_tiempo),'YEAR'), 'YYYY') as integer )from ASUNTO_CONSECUTIVO_AREA where id_area = #empleado_capt.area.id_area#)
            then 1
            else
            (select NVL( max(consecutivo) + 1,'1') folio from  asunto_consecutivo_area where id_area=#empleado_capt.area.id_area#
            and TO_CHAR(TRUNC(MARCA_TIEMPO, 'YEAR'), 'YYYY') = TO_CHAR(TRUNC(SYSDATE, 'YEAR'), 'YYYY') ) END folio
            from dual), #folio#)
    </insert>


    <select id="getIdConcentrado" resultClass="java.lang.Integer">
		SELECT seq_concentrado.nextval FROM dual
    </select>


    <insert id="insertConcentrado" parameterClass="java.util.HashMap">
		INSERT INTO concentrado_asunto(id_concentrado, id_asunto, id_asunto_detalle)
		VALUES (#id_concentrado#, #id_asunto#, #id_asunto_detalle#)
    </insert>


    <update id="update" parameterClass="mx.gob.economia.scg.model.Asunto">
		UPDATE asunto SET
			id_empleado_remi = #asunto_detalle.empleado_remi.id_empleado#,
			id_empleado_dest = #asunto_detalle.empleado_dest.id_empleado#,
			estatus = #estatus#
		WHERE id_asunto=#id_asunto#
    </update>


    <delete id="delete" parameterClass="java.lang.Integer">
		DELETE FROM asunto WHERE id_asunto = #id_asunto#
    </delete>


    <delete id="deleteAsuntoRecepcion" parameterClass="java.lang.Integer">
		DELETE FROM asunto_recepcion WHERE id_asunto = #id_asunto#
    </delete>


    <delete id="deleteAsuntoCcp" parameterClass="java.lang.Integer">
		DELETE FROM asunto_ccp WHERE id_asunto = #id_asunto#
    </delete>

    <delete id="deleteAsuntoConsecutivoArea" parameterClass="java.lang.Integer">
		DELETE FROM ASUNTO_CONSECUTIVO_AREA WHERE id_asunto = #id_asunto#
    </delete>


    <insert id="insertCcp" parameterClass="java.util.HashMap">
		INSERT INTO asunto_ccp(id_empleado, id_asunto)
		VALUES (#id_empleado#, #id_asunto#)
    </insert>


    <insert id="insertCcpTurno" parameterClass="java.util.HashMap">
		INSERT INTO asunto_detalle_ccp(id_asunto_detalle, id_empleado)
		VALUES (#id_asunto_detalle#, #id_empleado#)
    </insert>

    <insert id="insertCcpTurnoCapt" parameterClass="java.util.HashMap">
		INSERT INTO asunto_detalle_ccp_capt(id_asunto_detalle, id_empleado)
		VALUES (#id_asunto_detalle#, #id_empleado#)
    </insert>

    <insert id="insertCcpAtencionParcial" parameterClass="java.util.HashMap">
		INSERT INTO ASUNTO_ATT_PARC_CCP_CAPT(id_asunto_detalle, id_empleado)
		VALUES (#id_asunto_detalle#, #id_empleado#)
    </insert>

    <delete id="deleteCcpTurnoCapt" parameterClass="java.lang.Integer">
		DELETE FROM asunto_detalle_ccp_capt WHERE id_asunto_detalle = #id_asunto_detalle#
    </delete>

    <delete id="deleteCcpAtencionParcial" parameterClass="java.lang.Integer">
		DELETE FROM ASUNTO_ATT_PARC_CCP_CAPT WHERE id_asunto_detalle = #id_asunto_detalle#
    </delete>

    <delete id="deleteAsuntoCcpTurno" parameterClass="java.lang.Integer">
		DELETE FROM asunto_detalle_ccp WHERE id_asunto_detalle = #id_asunto_detalle#
    </delete>

    <update id="updateFhLecturaCcp" parameterClass="java.util.HashMap">
		UPDATE asunto_ccp
		SET fh_lectura = #fh_lectura#
		WHERE id_empleado = #id_empleado#
		AND id_asunto = #id_asunto#
		AND fh_lectura IS NULL
    </update>


    <select id="listAsuntoAsociados" resultMap="asuntoDetalleMap" parameterClass="java.lang.Integer">
		SELECT a.folio, a.folio || '-' || a.contador_folio contador_folio,
	            a.id_asunto, a.asunto, a.descripcion, a.no_oficio, a.fh_oficio, a.fh_recepcion, a.id_empleado_capt,
	            CASE to_number(to_char(ad.fh_limite-2,'d'))
	            WHEN 7 THEN ad.fh_limite-4
	            WHEN 6 THEN ad.fh_limite-4
	            ELSE ad.fh_limite-2 END AS fh_por_vencer, ad.estatus,
	            c.correo AS correo_capt, c.nombre AS nombre_capt,
	            c.paterno AS paterno_capt, c.materno AS materno_capt,
	            c.id_area AS id_area_capt, ac.area AS area_capt, c.activo AS activo_capt, c.puesto AS puesto_capt,
	            ad.id_asunto_detalle, ad.fh_lectura, ad.fh_registro, ad.fh_limite, ad.comentario, ad.ip,
	            r.id_empleado AS id_empleado_remi, r.correo AS correo_remi, r.nombre AS nombre_remi,
	            r.paterno AS paterno_remi, r.materno AS materno_remi,
	            r.id_area AS id_area_remi, ar_r.area AS area_remi, r.activo AS activo_remi, r.puesto AS puesto_remi,
	            d.id_empleado AS id_empleado_dest, d.correo AS correo_dest, d.nombre AS nombre_dest,
	            d.paterno AS paterno_dest, d.materno AS materno_dest,
	            d.id_area AS id_area_dest, ar_d.area AS area_dest, d.activo AS activo_dest, d.puesto AS puesto_dest,
	            i.id_empleado AS id_empleado_ini, i.correo AS correo_ini, i.nombre AS nombre_ini,
	            i.paterno AS paterno_ini, i.materno AS materno_ini,
	            i.id_area AS id_area_ini, ar_i.area AS area_ini, i.activo AS activo_ini, i.puesto AS puesto_ini,
	            ca.id_concentrado, a.id_asunto_padre, a.id_expediente, e.expediente, a.id_tema, t.id_tema_padre, t.tema, t.evento tema_evento, a.fh_evento,
	            a.id_instruccion, ins.instruccion, a.id_tipo_asunto, ad.id_prioridad, a.confidencial,
                    (select count(*) from asunto_atencion_parcial aap where aap.id_asunto = a.id_asunto) atencionParcial
	        FROM asunto a
	        LEFT JOIN empleado c ON c.id_empleado = a.id_empleado_capt
	        LEFT JOIN area ac ON ac.id_area = c.id_area
	        LEFT JOIN asunto_detalle ad ON a.id_asunto = ad.id_asunto
	        LEFT JOIN empleado d ON d.id_empleado = ad.id_empleado_dest
	        LEFT JOIN area ar_d ON ar_d.id_area = d.id_area
	        LEFT JOIN empleado r ON r.id_empleado = ad.id_empleado_remi
	        LEFT JOIN area ar_r ON ar_r.id_area = r.id_area
	        LEFT JOIN empleado i ON i.id_empleado = ad.id_empleado_ini
	        LEFT JOIN area ar_i ON ar_i.id_area = i.id_area
		LEFT JOIN concentrado_asunto ca ON ca.id_asunto = a.id_asunto and ca.id_asunto_detalle = ad.id_asunto_detalle
		LEFT JOIN expediente e ON e.id_expediente = a.id_expediente
		LEFT JOIN tema t ON t.id_tema = a.id_tema
		LEFT JOIN instruccion ins ON ins.id_instruccion = a.id_instruccion
                LEFT JOIN evento ev ON ev.id_evento = a.id_evento
		WHERE ca.id_concentrado = #id_concentrado#
    </select>
    <select id="listAsuntosVolante" resultMap="asuntoReporteVolanteMap" parameterClass="mx.gob.economia.scg.model.CriterioReporteVolante">
		select asunto.id_asunto,asunto.asunto,asunto.descripcion,asunto.no_oficio,
                fh_oficio,id_asunto_ref,asunto.estatus,fh_recepcion,tema,expediente,folio,
                fh_limite,destinatario.nombre destinatario_nombre, destinatario.paterno destinatario_paterno, destinatario.materno destinatario_materno, remitente.nombre remitente_nombre,remitente.paterno remitente_paterno
                , remitente.materno remitente_materno,id_tipo_asunto
                from asunto, asunto_detalle, empleado destinatario,empleado remitente,expediente, tema
                where asunto.id_asunto = asunto_detalle.id_asunto and asunto.id_empleado_dest = destinatario.id_empleado
                and remitente.id_empleado = asunto.id_empleado_remi and asunto.id_expediente = expediente.id_expediente
                and tema.id_tema = asunto.id_tema
        <dynamic prepend="">
            <isNotNull prepend="" property="fh_registroIni">
                <isNotNull prepend="AND" property="fh_registroIni">
	 				asunto.fh_oficio BETWEEN #fh_registroIni# AND #fh_registroFin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="" property="id_area">
                <isNotEqual prepend="AND" property="id_area" compareValue="-1">
					remitente.id_area in ( select id_area from area connect by prior id_area = id_area_padre start with id_area = #id_area#)
                </isNotEqual>
            </isNotNull>


            <isNotNull prepend="" property="id_tema">
                <isNotEqual prepend="AND" property="id_tema" compareValue="-1">
					tema.id_tema = #id_tema#
                </isNotEqual>
            </isNotNull>


            <isNotNull prepend="" property="id_expediente">
                <isNotEqual prepend="AND" property="id_expediente" compareValue="-1">
					expediente.id_expediente = #id_expediente#
                </isNotEqual>
            </isNotNull>
        </dynamic>
    </select>
    <select id="getIdConcentradoAsunto" resultClass="java.lang.Integer" parameterClass="java.lang.Integer">
		SELECT max(ID_CONCENTRADO)
                FROM CONCENTRADO_ASUNTO
		WHERE ID_ASUNTO = #id_asunto#
    </select>
    <select id="getSigContadorFolio" resultClass="java.lang.String" parameterClass="java.lang.String">
		SELECT LPAD(MAX(TO_NUMBER(CONTADOR_FOLIO))+1,2,'0') SIGCONTADORFOLIO
                FROM ASUNTO
                WHERE FOLIO='$folio$'
    </select>
    <select id="getContadorFoliobyId" resultClass="java.lang.String" parameterClass="java.lang.Integer">
		SELECT folio || '-' || contador_folio contador_folio
                FROM asunto
                WHERE id_asunto = #id_asunto#
    </select>
    <update id="updateEstatusRevisor" parameterClass="mx.gob.economia.scg.model.AsuntoDetalle">
		UPDATE asunto SET id_empleado_revi=#empleado_revi.id_empleado#, estatus=#estatus# WHERE
        <isNotEmpty prepend="" property="ids_asunto">
            <iterate prepend="" property="ids_asunto" open="(" close=")" conjunction="OR">
                    id_asunto = #ids_asunto[]#
            </iterate>
        </isNotEmpty>
    </update>
    <update id="updateComentario" parameterClass="mx.gob.economia.scg.model.Asunto">
		UPDATE asunto_detalle SET
			comentario = #asunto_detalle.comentario#
		WHERE id_asunto=#id_asunto#
    </update>

    <select id="getIdsAsuntoByCriterio_ultimo" parameterClass="mx.gob.economia.scg.model.CriterioAsunto" resultClass="java.lang.String">
		SELECT max(id_asunto) FROM asunto
        <dynamic prepend="WHERE">
            <isNotNull prepend="" property="folio">
                <isNotEqual prepend="AND" property="folio" compareValue="">
                           folio = '$folio$'
                </isNotEqual>
                <isNotEqual prepend="AND" property="contador_folio" compareValue="">
                           contador_folio = '$contador_folio$'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="AND" property="fh_oficio_ini">
				fh_oficio = #fh_oficio_ini#
            </isNotNull>
            <isNotNull prepend="AND" property="fh_recepcion_ini">
				fh_recepcion = #fh_recepcion_ini#
            </isNotNull>
            <isNotNull prepend="" property="id_asunto_ref">
                <isNotEqual prepend="AND" property="id_asunto_ref" compareValue="" >
                                        id_asunto_ref = '$id_asunto_ref$'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="no_oficio">
                <isNotEqual prepend="AND" property="no_oficio" compareValue="">
					no_oficio = #no_oficio#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="asunto">
                <isNotEqual prepend="AND" property="asunto" compareValue="">
					asunto LIKE '%$asunto$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="descripcion">
                <isNotEqual prepend="AND" property="descripcion" compareValue="">
					descripcion LIKE '%$descripcion$%'
                </isNotEqual>
            </isNotNull>
        </dynamic>
    </select>

    <select id="listAsuntosInicialesNuevasReglas" parameterClass="mx.gob.economia.scg.model.CriterioAsunto" resultMap="asuntoDetalleMap">
    SELECT * FROM (
	SELECT vista.*, rownum r FROM(
         SELECT a.folio,
                a.id_asunto, a.asunto, a.descripcion, a.no_oficio, a.fh_oficio, a.fh_recepcion, a.id_empleado_capt,
                CASE to_number(to_char(ad.fh_limite-2,'d'))
                WHEN 7 THEN ad.fh_limite-4
                WHEN 6 THEN ad.fh_limite-4
                ELSE ad.fh_limite-2 END AS fh_por_vencer,

                <!-- Esta nueva opcin muestra las reglas de Estatus -->
               (SELECT ESTATUS_DET
                            FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                    FROM ASUNTO_DETALLE AD3
                                   WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#) OR
                                          AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                                          AD3.ID_EMPLEADO_REMI IN (SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                                          AD3.ID_EMPLEADO_DEST IN (SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#))
                                   GROUP BY AD3.ID_ASUNTO) AD_EST
                           WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) Max_estatus,
                CASE
                    <!-- ESTATUS ASUNTO = 0 AND ESTATUS ASUNTO_DETALLE = 2 THEN ESTATUS = 1 -->
                    WHEN (SELECT ESTATUS_DET
                    FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                    FROM ASUNTO_DETALLE AD3
                    WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#) OR
                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                    AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#))
                    GROUP BY AD3.ID_ASUNTO) AD_EST
                    WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0 AND A.ESTATUS =2 THEN 1

                    <!-- ESTATUS ASUNTO = 0 AND ESTATUS ASUNTO_DETALLE = 2 THEN ESTATUS = 1 -->
                    WHEN (SELECT ESTATUS_DET
                    FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                    FROM ASUNTO_DETALLE AD3
                    WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#) OR
                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                    AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#))
                    GROUP BY AD3.ID_ASUNTO) AD_EST
                    WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1 AND A.ESTATUS =2 THEN 1

                    <!-- SI NO APLICA EN LAS ANTERIORES UTILIZA ESTATUS ASUNTO -->
                ELSE A.ESTATUS
                END AS ESTATUS,

                <!-- ************************************************************************* -->

                c.correo AS correo_capt, c.nombre AS nombre_capt,
                c.paterno AS paterno_capt, c.materno AS materno_capt,
                c.id_area AS id_area_capt, ac.area AS area_capt, c.activo AS activo_capt, c.puesto AS puesto_capt,
                ad.id_asunto_detalle, ad.fh_lectura, ad.fh_registro, ad.fh_limite, ad.comentario, ad.ip,
                r.id_empleado AS id_empleado_remi, r.correo AS correo_remi, r.nombre AS nombre_remi,
                r.paterno AS paterno_remi, r.materno AS materno_remi,
                r.id_area AS id_area_remi, ar_r.area AS area_remi, r.activo AS activo_remi, r.puesto AS puesto_remi,
                d.id_empleado AS id_empleado_dest, d.correo AS correo_dest, d.nombre AS nombre_dest,
                d.paterno AS paterno_dest, d.materno AS materno_dest,
                d.id_area AS id_area_dest, ar_d.area AS area_dest, d.activo AS activo_dest, d.puesto AS puesto_dest,
                i.id_empleado AS id_empleado_ini, i.correo AS correo_ini, i.nombre AS nombre_ini,
                i.paterno AS paterno_ini, i.materno AS materno_ini,
                i.id_area AS id_area_ini, ar_i.area AS area_ini, i.activo AS activo_ini, i.puesto AS puesto_ini, a.id_asunto_padre,
                a.id_expediente, e.expediente, a.id_tema, t.id_tema_padre, t.tema, t.evento tema_evento, a.fh_evento,
                a.id_instruccion, ins.instruccion, a.id_tipo_asunto, ad.id_prioridad, a.antecedente, a.confidencial,
                a.folio || '-' || a.contador_folio contador_folio,
                (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) atencionParcial
            FROM asunto a,
               empleado c,
               empleado empleadoRemiAsunto,
               area areaRemiAsunto,
               empleado empleadoDestAsunto,
               area areaDestAsunto,
               area ac,
               asunto_detalle ad,
               empleado d,
               area ar_d,
               empleado r,
               area ar_r,
               empleado i,
               area ar_i,
               expediente e,
               tema t,
               instruccion ins
            where a.id_empleado_capt = c.id_empleado
            and a.ID_EMPLEADO_REMI = empleadoRemiAsunto.id_empleado
            and a.ID_EMPLEADO_DEST = empleadoDestAsunto.id_empleado
            and a.id_asunto = ad.id_asunto
            and a.id_expediente = e.id_expediente(+)
            and a.id_tema = t.id_tema(+)
            and a.id_instruccion = ins.id_instruccion
            and c.id_area = ac.id_area
            and empleadoRemiAsunto.id_area = areaRemiAsunto.id_area
            and empleadoDestAsunto.id_area = areaDestAsunto.id_area
            and ad.id_empleado_remi  = r.id_empleado
            and ad.id_empleado_dest  = d.id_empleado
            and ad.id_empleado_ini = i.id_empleado(+)
            and d.id_area  = ar_d.id_area
            and r.id_area = ar_r.id_area
            and i.id_area = ar_i.id_area(+)
        <dynamic prepend="">

            <isNotNull prepend="" property="estatus">
                <isNotEqual prepend="" property="estatus" compareValue="">
                    <isEqual prepend="AND" property="estatus" compareValue="0">
                        <isEqual prepend="" property="bandeja" compareValue="1">
                       (D.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_DEST)
                                                FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                               WHERE ID_AREA = #id_area_dest#
                                                 AND AD3.ID_EMPLEADO_DEST = D.ID_EMPLEADO) )
                        </isEqual>
                        <isEqual prepend="" property="bandeja" compareValue="2">
                       (R.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_REMI)
                                                 FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                                WHERE ID_AREA = #id_area_remi#
                                                  AND AD3.ID_EMPLEADO_REMI = R.ID_EMPLEADO))
                        </isEqual>
                       AND CASE
                            WHEN A.ESTATUS = 2 AND  (SELECT ESTATUS_DET
                                                       FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                               FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                            GROUP BY AD3.ID_ASUNTO) AD_EST
                                                      WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0
                            THEN 1
                            WHEN A.ESTATUS = 2 AND (SELECT ESTATUS_DET
                                                      FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                              FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                             GROUP BY AD3.ID_ASUNTO) AD_EST
                                                     WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1
                            THEN 1
                            ELSE A.ESTATUS
                       END = 0
                       AND AD.ID_ASUNTO_DETALLE IN (SELECT MAX
                                                      FROM (SELECT MAX(AD2.ID_ASUNTO_DETALLE) AS MAX, AD2.ID_ASUNTO
                                                              FROM ASUNTO_DETALLE AD2, ASUNTO A
                                                             WHERE AD2.ID_ASUNTO = A.ID_ASUNTO
                                                               AND AD2.ID_ASUNTO IN (SELECT AD3.ID_ASUNTO
                                                                                       FROM ASUNTO_DETALLE AD3
                                                                                        WHERE (
                                                                                    <isEqual prepend="" property="bandeja" compareValue="1">
                                                                                        AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                                                    </isEqual>
                                                                                    <isEqual prepend="" property="bandeja" compareValue="2">
                                                                                        AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                                                    </isEqual>
                                                                                        )
                                                                                    )
                                                             GROUP BY AD2.ID_ASUNTO
                                                            )
                                                    )
                       AND (SELECT COUNT(*)
                              FROM ASUNTO_ATENCION_PARCIAL AAP
                             WHERE AAP.ID_ASUNTO_DETALLE = AD.ID_ASUNTO_DETALLE)= 0
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="1">
                        <isEqual prepend="" property="bandeja" compareValue="1">
                       (D.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_DEST)
                                                FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                               WHERE ID_AREA = #id_area_dest#
                                                 AND AD3.ID_EMPLEADO_DEST = D.ID_EMPLEADO) )
                        </isEqual>
                        <isEqual prepend="" property="bandeja" compareValue="2">
                       (R.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_REMI)
                                                 FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                                WHERE ID_AREA = #id_area_remi#))
                        </isEqual>
                       AND CASE
                            WHEN A.ESTATUS = 2 AND  (SELECT ESTATUS_DET
                                                       FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                               FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                              GROUP BY AD3.ID_ASUNTO) AD_EST
                                                      WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0
                            THEN 1
                            WHEN A.ESTATUS = 2 AND (SELECT ESTATUS_DET
                                                      FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                              FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                             GROUP BY AD3.ID_ASUNTO) AD_EST
                                                     WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1
                            THEN 1
                            ELSE A.ESTATUS
                       END = 1
                       AND AD.ID_ASUNTO_DETALLE IN (SELECT MAX
                                                      FROM (SELECT MAX(AD2.ID_ASUNTO_DETALLE) AS MAX, AD2.ID_ASUNTO
                                                              FROM ASUNTO_DETALLE AD2, ASUNTO A
                                                             WHERE AD2.ID_ASUNTO = A.ID_ASUNTO
                                                               AND AD2.ID_ASUNTO IN (SELECT AD3.ID_ASUNTO
                                                               FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                                                    )
                                                             GROUP BY AD2.ID_ASUNTO
                                                            )
                                                    )
                        AND (SELECT COUNT(*)
                               FROM ASUNTO_ATENCION_PARCIAL AAP
                              WHERE AAP.ID_ASUNTO_DETALLE = AD.ID_ASUNTO_DETALLE)= 0
                        <isEqual prepend="" property="bandeja" compareValue="2">
                        AND (CASE
                                   WHEN (SELECT ESTATUS_DET
                                           FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                   FROM ASUNTO_DETALLE AD3
                                                    WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#) OR
                                                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                                                    AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                                                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#))
                                                  GROUP BY AD3.ID_ASUNTO) AD_EST
                                          WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0 AND A.ESTATUS =2 THEN 1
                                    WHEN (SELECT ESTATUS_DET
                                            FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                    FROM ASUNTO_DETALLE AD3
                                                    WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#) OR
                                                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                                                    AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                                                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#))
                                                   GROUP BY AD3.ID_ASUNTO) AD_EST
                                           WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1 AND A.ESTATUS =2 THEN 1
                                    ELSE A.ESTATUS
                               END ) = 1
                        </isEqual>
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="2">
                        <isEqual prepend="" property="bandeja" compareValue="1">
                       (D.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_DEST)
                                                FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                               WHERE ID_AREA = #id_area_dest#
                                                 AND AD3.ID_EMPLEADO_DEST = D.ID_EMPLEADO) )
                        </isEqual>
                        <isEqual prepend="" property="bandeja" compareValue="2">
                       (R.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_REMI)
                                                 FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                                WHERE ID_AREA = #id_area_remi#
                                                  AND AD3.ID_EMPLEADO_REMI = R.ID_EMPLEADO))
                        </isEqual>
                        AND CASE
                                WHEN A.ESTATUS = 2 AND  (SELECT ESTATUS_DET
                                                           FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                                   FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                                  GROUP BY AD3.ID_ASUNTO) AD_EST
                                                          WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0
                                THEN 1
                                WHEN A.ESTATUS = 2 AND (SELECT ESTATUS_DET
                                                          FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                                  FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                                 GROUP BY AD3.ID_ASUNTO) AD_EST
                                                         WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1
                                THEN 1
                                ELSE A.ESTATUS
                        END = 2
                        AND AD.ID_ASUNTO_DETALLE IN (SELECT MAX
                                                       FROM (SELECT MAX(AD2.ID_ASUNTO_DETALLE) AS MAX, AD2.ID_ASUNTO
                                                               FROM ASUNTO_DETALLE AD2, ASUNTO A
                                                              WHERE AD2.ID_ASUNTO = A.ID_ASUNTO
                                                                AND AD2.ID_ASUNTO IN (SELECT AD3.ID_ASUNTO
                                                                                        FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                                                      )
                                                              GROUP BY AD2.ID_ASUNTO
                                                            )
                                                    )
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="3">
                        (D.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_DEST)
                                                 FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                                WHERE ID_AREA = #id_area_capt#
                                                  AND AD3.ID_EMPLEADO_DEST = D.ID_EMPLEADO)
                            OR R.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_REMI)
                                                   FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                                  WHERE ID_AREA = #id_area_capt#
                                                    AND AD3.ID_EMPLEADO_REMI = R.ID_EMPLEADO))
                        AND CASE
                                WHEN A.ESTATUS = 2 AND  (SELECT ESTATUS_DET
                                                           FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                                   FROM ASUNTO_DETALLE AD3
                                                                  WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_capt#) OR
                                                                         AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_capt# ))
                                                                  GROUP BY AD3.ID_ASUNTO) AD_EST
                                                          WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0
                                THEN 1
                                WHEN A.ESTATUS = 2 AND (SELECT ESTATUS_DET
                                                          FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                                  FROM ASUNTO_DETALLE AD3
                                                                  WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_capt#) OR
                                                                         AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_capt# ))
                                                                 GROUP BY AD3.ID_ASUNTO) AD_EST
                                                         WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1
                                THEN 1
                                ELSE A.ESTATUS
                        END = 3
                        AND AD.ID_ASUNTO_DETALLE IN (SELECT MAX
                                                       FROM (SELECT MAX(AD2.ID_ASUNTO_DETALLE) AS MAX, AD2.ID_ASUNTO
                                                               FROM ASUNTO_DETALLE AD2, ASUNTO A
                                                              WHERE AD2.ID_ASUNTO = A.ID_ASUNTO
                                                                AND AD2.ID_ASUNTO IN (SELECT AD3.ID_ASUNTO
                                                                                        FROM ASUNTO_DETALLE AD3
                                                                                      WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_capt#) OR
                                                                                             AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_capt# ))
                                                                                     )
                                                              GROUP BY AD2.ID_ASUNTO
                                                            )
                                                    )
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="7">
                               a.estatus = #estatus#
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="14">
                        <isEqual prepend="" property="bandeja" compareValue="1">
                       (D.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_DEST)
                                                FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                               WHERE ID_AREA = #id_area_dest#
                                                 AND AD3.ID_EMPLEADO_DEST = D.ID_EMPLEADO) )
                        </isEqual>
                        <isEqual prepend="" property="bandeja" compareValue="2">
                       (R.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_REMI)
                                                 FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                                WHERE ID_AREA = #id_area_remi#
                                                  AND AD3.ID_EMPLEADO_REMI = R.ID_EMPLEADO))
                        </isEqual>
                        AND CASE
                                WHEN A.ESTATUS = 2 AND (SELECT ESTATUS_DET
                                                          FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                                  FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                                 GROUP BY AD3.ID_ASUNTO) AD_EST
                                                         WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0
                                THEN 1
                                WHEN A.ESTATUS = 2 AND (SELECT ESTATUS_DET
                                    FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                            FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                             GROUP BY AD3.ID_ASUNTO) AD_EST
                                   WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1
                                THEN 1
                                ELSE A.ESTATUS
                        END IN (0,1)
                        AND AD.ID_ASUNTO_DETALLE IN (SELECT MAX
                                                       FROM (SELECT MAX(AD2.ID_ASUNTO_DETALLE) AS MAX, AD2.ID_ASUNTO
                                                               FROM ASUNTO_DETALLE AD2, ASUNTO A
                                                              WHERE AD2.ID_ASUNTO = A.ID_ASUNTO
                                                                AND AD2.ID_ASUNTO IN (SELECT AD3.ID_ASUNTO
                                                                                        FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                                                     )
                                                              GROUP BY AD2.ID_ASUNTO
                                                            )
                                                    )
                        AND (SELECT COUNT(*)
                               FROM ASUNTO_ATENCION_PARCIAL AAP
                              WHERE AAP.ID_ASUNTO_DETALLE = AD.ID_ASUNTO_DETALLE)> 0
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="-1">
                        <isEqual prepend="" property="bandeja" compareValue="1">
                       (D.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_DEST)
                                                FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                               WHERE ID_AREA = #id_area_dest#
                                                 AND AD3.ID_EMPLEADO_DEST = D.ID_EMPLEADO) )
                        </isEqual>
                        <isEqual prepend="" property="bandeja" compareValue="2">
                       (R.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_REMI)
                                                 FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                                WHERE ID_AREA = #id_area_remi#
                                                  AND AD3.ID_EMPLEADO_REMI = R.ID_EMPLEADO))
                        </isEqual>
                       AND CASE
                            WHEN A.ESTATUS = 2 AND  (SELECT ESTATUS_DET
                                                       FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                               FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                              GROUP BY AD3.ID_ASUNTO) AD_EST
                                                      WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0
                             THEN 1
                             WHEN A.ESTATUS = 2 AND (SELECT ESTATUS_DET
                                                       FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                               FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                              GROUP BY AD3.ID_ASUNTO) AD_EST
                                                      WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1
                            THEN 1
                            ELSE A.ESTATUS
                       END IN (0,1,2)
                       AND AD.ID_ASUNTO_DETALLE IN (SELECT MAX
                                                      FROM (SELECT MAX(AD2.ID_ASUNTO_DETALLE) AS MAX, AD2.ID_ASUNTO
                                                              FROM ASUNTO_DETALLE AD2, ASUNTO A
                                                             WHERE AD2.ID_ASUNTO = A.ID_ASUNTO
                                                               AND AD2.ID_ASUNTO IN (SELECT AD3.ID_ASUNTO
                                                                                       FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                                                    )
                                                          GROUP BY AD2.ID_ASUNTO
                                                            )
                                                    )
                    </isEqual>
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="ids_asunto">
                <iterate prepend="AND" property="ids_asunto"
			open="(" close=")" conjunction="OR">
				a.id_asunto=#ids_asunto[]#
                </iterate>
            </isNotNull>
            <isNotNull prepend="" property="folio">
                <isNotEqual prepend="AND" property="folio" compareValue="">
						a.folio LIKE '$folio$'
                </isNotEqual>
            </isNotNull>

             <!--inicio AGG Filtro por referencia 20111107 -->
            <isNotNull prepend="" property="id_asunto_ref">
                <isNotEqual prepend="AND" property="id_asunto_ref" compareValue="">
						a.id_asunto_ref LIKE upper('%$id_asunto_ref$%')
                </isNotEqual>
            </isNotNull>
            <!--fin AGG Filtro por referencia 20111107 -->

            <isNotNull prepend="" property="id_asunto">
                <isNotEqual prepend="AND" property="id_asunto" compareValue="">
						a.id_asunto = #id_asunto#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="asunto">
                <isNotEqual prepend="AND" property="asunto" compareValue="">
						a.asunto LIKE '%$asunto$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="descripcion">
                <isNotEqual prepend="AND" property="descripcion" compareValue="">
						a.descripcion LIKE '%$descripcion$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="no_oficio">
                <isNotEqual prepend="AND" property="no_oficio" compareValue="">
						a.no_oficio LIKE '%$no_oficio$%'
                </isNotEqual>
            </isNotNull>

            <isNotNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio BETWEEN #fh_oficio_ini# AND #fh_oficio_fin#
                </isNotNull>
                <isNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio BETWEEN #fh_oficio_ini# AND SYSDATE
                </isNull>
            </isNotNull>
            <isNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio = #fh_oficio_fin#
                </isNotNull>
            </isNull>

            <isNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio = #fh_oficio_fin#
                </isNotNull>
            </isNull>

            <isNotNull prepend="" property="fh_recepcion_ini">
                <isNotNull prepend="AND" property="fh_recepcion_fin">
		 				a.fh_recepcion BETWEEN #fh_recepcion_ini# AND #fh_recepcion_fin#
                </isNotNull>
            </isNotNull>

            <isNotNull prepend="" property="fh_lectura_ini">
                <isNotNull prepend="AND" property="fh_lectura_fin">
					ad.fh_lectura BETWEEN #fh_lectura_ini# AND #fh_lectura_fin#
                </isNotNull>
                <isNull prepend="AND" property="fh_lectura_fin">
					ad.fh_lectura BETWEEN #fh_lectura_ini# AND SYSDATE
                </isNull>
            </isNotNull>
            <isNull prepend="" property="fh_lectura_ini">
                <isNotNull prepend="AND" property="fh_lectura_fin">
					ad.fh_lectura = #fh_lectura_fin#
                </isNotNull>
            </isNull>

            <isNotNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
					ad.fh_registro BETWEEN #fh_registro_ini# AND #fh_registro_fin#
            </isNotNull>
                <isNull prepend="AND" property="fh_registro_fin">
					ad.fh_registro BETWEEN #fh_registro_ini# AND SYSDATE
                </isNull>
            </isNotNull>
            <isNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
					ad.fh_registro = #fh_registro_fin#
                </isNotNull>
            </isNull>

            <isNotNull prepend="" property="fh_limite_ini">
                <isNotNull prepend="AND" property="fh_limite_fin">
					ad.fh_limite BETWEEN #fh_limite_ini# AND #fh_limite_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="AND" property="fh_limite_ini">
				ad.fh_limite = #fh_limite_ini#
            </isNotNull>
            <isNotNull prepend="" property="id_prioridad">
                <isGreaterThan prepend="AND" property="id_prioridad" compareValue="-1">
                    ad.id_prioridad = #id_prioridad#
                </isGreaterThan>
            </isNotNull>
            <isNotNull prepend="" property="id_tipo_documento">
                <isGreaterThan prepend="AND" property="id_tipo_documento" compareValue="-1">
                    a.id_tipo_asunto = #id_tipo_documento#
                </isGreaterThan>
            </isNotNull>
            <isNotNull prepend="" property="nombre_capt">
                <isNotEqual prepend="AND" property="nombre_capt" compareValue="">
						c.nombre LIKE '%$nombre_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_capt">
                <isNotEqual prepend="AND" property="paterno_capt" compareValue="">
						c.paterno LIKE '%$paterno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_capt">
                <isNotEqual prepend="AND" property="materno_capt" compareValue="">
						c.materno LIKE '%$materno_capt$%'
                </isNotEqual>
            </isNotNull><isNotNull prepend="" property="id_tema">
                <isNotEqual prepend="AND" property="id_tema" compareValue="-1">
						a.id_tema = #id_tema#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_expediente">
                <isNotEqual prepend="AND" property="id_expediente" compareValue="-1">
						a.id_expediente = #id_expediente#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_evento">
                <isNotEqual prepend="AND" property="id_evento" compareValue="-1">
						a.id_evento = #id_evento#
                </isNotEqual>
            </isNotNull>
            <!--
            <isNotNull prepend="" property="id_area_capt">
                <isNotEqual prepend="AND" property="id_area_capt" compareValue="">
                    (c.id_area = #id_area_capt#
                    or empleadoRemiAsunto.ID_AREA = #id_area_capt#
                    or empleadoDestAsunto.ID_AREA = #id_area_capt#)
                </isNotEqual>
            </isNotNull>
            -->
            <isNotNull prepend="" property="ids_empleados_ccp">
                <isNotEqual prepend="AND" property="ids_empleados_ccp" compareValue="">
                     (a.id_asunto in (select distinct id_asunto
                                      from asunto_detalle
                                      WHERE id_asunto_detalle IN (SELECT id_asunto_detalle
                                                                  FROM asunto_detalle_ccp
                                                                  WHERE id_empleado in ($ids_empleados_ccp$))
                                         or id_asunto_detalle IN (SELECT id_asunto_detalle
                                                                  FROM ASUNTO_ATT_PARC_CCP_CAPT
                                                                  WHERE id_empleado in ($ids_empleados_ccp$)))
                       or a.id_asunto in (SELECT id_asunto
                                          FROM asunto_ccp
                                          WHERE id_empleado in ($ids_empleados_ccp$)))
                </isNotEqual>
            </isNotNull>

            <isNotNull prepend="" property="confidencial">
                <isEqual prepend="AND" property="confidencial" compareValue="1" >
                                        a.confidencial = 1
                </isEqual>
                <isEqual prepend="AND" property="confidencial" compareValue="0" >
                                        a.confidencial = 0
                </isEqual>
            </isNotNull>
            <!--
            <isNotNull prepend="" property="enTramite">
                <isEqual prepend="AND" property="enTramite" compareValue="1" >
                            (a.estatus = 0 OR a.estatus = 1)
                            and (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) >0
                </isEqual>
                <isEqual prepend="AND" property="enTramite" compareValue="0" >
                                        (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) =0
                </isEqual>
            </isNotNull>
            -->
            <isEqual prepend="" property="busqueda_detalle" compareValue="0">
                <!-- and ad.id_asunto_detalle =  (select max(ID_ASUNTO_DETALLE) from asunto_detalle ad2 WHERE ad2.id_asunto = a.id_asunto) -->
                <isEqual prepend="AND" property="busqueda_modificado" compareValue="1">
                    a.estatus != 3
                    and a.id_asunto in (SELECT id_asunto
                                        FROM asunto_captura_actualizacion a
                                        WHERE a.estatus !=7
                                          and a.tipo_actualizacion = 0
                                          and id_empleado_dest = #id_empleado_dest#)
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="1">
                    ar_r.tipo = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="2">
                    ar_r.tipo = 1
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="1">
                    ar_d.tipo = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="2">
                    ar_d.tipo = 1
                </isEqual>

                <isNotNull prepend="" property="id_empleado_remi">
                    <isNotEqual prepend="AND" property="id_empleado_remi" compareValue="">
						a.id_empleado_remi = #id_empleado_remi#
                    </isNotEqual>
                </isNotNull>
                <!--
                <isNotNull prepend="" property="id_area_remi">
                    <isNotEqual prepend="AND" property="id_area_remi" compareValue="">
						r.id_area = #id_area_remi#
                    </isNotEqual>
                </isNotNull>
                -->
                <isNotNull prepend="" property="nombre_remi">
                    <isNotEqual prepend="AND" property="nombre_remi" compareValue="">
						r.nombre LIKE '%$nombre_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_remi">
                    <isNotEqual prepend="AND" property="paterno_remi" compareValue="">
						r.paterno LIKE '%$paterno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_remi">
                    <isNotEqual prepend="AND" property="materno_remi" compareValue="">
						r.materno LIKE '%$materno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isEqual prepend="" property="busqueda_modificado" compareValue="0">
                    <isNotNull prepend="" property="id_empleado_dest">
                        <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                                    a.id_empleado_dest = #id_empleado_dest#
                        </isNotEqual>
                    </isNotNull>
                </isEqual>
                <!--
                <isNotNull prepend="" property="id_area_dest">
                    <isNotEqual prepend="AND" property="id_area_dest" compareValue="">
						d.id_area = #id_area_dest#
                    </isNotEqual>
                </isNotNull>
                -->
                <isNotNull prepend="" property="nombre_dest">
                    <isNotEqual prepend="AND" property="nombre_dest" compareValue="">
						d.nombre LIKE '%$nombre_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_dest">
                    <isNotEqual prepend="AND" property="paterno_dest" compareValue="">
						d.paterno LIKE '%$paterno_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_dest">
                    <isNotEqual prepend="AND" property="materno_dest" compareValue="">
						d.materno LIKE '%$materno_dest$%'
                    </isNotEqual>
                </isNotNull>
                <!--
                <isNotEmpty prepend="" property="ids_estatus">
                    <iterate prepend="AND" property="ids_estatus"
                             open="(" close=")" conjunction="OR">
				   a.estatus =#ids_estatus[]#
                    </iterate>
                </isNotEmpty>
                -->
            </isEqual>
            <isEqual prepend="" property="busqueda_detalle" compareValue="1">
                <isEmpty prepend="" property="historico">
                    and ad.id_asunto_detalle =  (select max(ID_ASUNTO_DETALLE) from asunto_detalle ad2 WHERE ad2.id_asunto = a.id_asunto)
                </isEmpty>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="1">
                    (select a2.tipo from area a2 where a2.id_area =(select e2.id_area from empleado e2 where e2.id_empleado = ad.id_empleado_remi)) = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="2">
                    (select a2.tipo from area a2 where a2.id_area =(select e2.id_area from empleado e2 where e2.id_empleado = ad.id_empleado_remi)) = 1
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="1">
                    (select a3.tipo from area a3 where a3.id_area =(select e3.id_area from empleado e3 where e3.id_empleado = ad.id_empleado_dest)) = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="2">
                    (select a3.tipo from area a3 where a3.id_area =(select e3.id_area from empleado e3 where e3.id_empleado = ad.id_empleado_dest)) = 1
                </isEqual>
                <isNotEmpty prepend="" property="ids_estatus">
                    <iterate prepend="AND" property="ids_estatus"
                             open="(" close=")" conjunction="OR">
				   ad.estatus =#ids_estatus[]#
                    </iterate>
                </isNotEmpty>
		<isNotNull prepend="" property="id_empleado_recep">
                    <isNotEqual prepend="AND" property="id_empleado_recep" compareValue="">
                        (SELECT ar.id_empleado FROM asunto_recepcion ar where ar.id_asunto = ad.id_asunto and ar.id_asunto_detalle = ad.id_asunto_detalle and ar.id_empleado = #id_empleado_recep#) = #id_empleado_recep#
                    </isNotEqual>
		</isNotNull>

                <isNotNull prepend="" property="id_empleado_remi">
                    <isNotEqual prepend="" property="id_empleado_remi" compareValue="">
                        <isNotNull prepend="" property="id_empleado_dest">
                            <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                (ad.id_empleado_remi = #id_empleado_remi#
                                 or ad.id_empleado_dest = #id_empleado_dest#)
                            </isNotEqual>
                        </isNotNull>
                        <isEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                ad.id_empleado_remi = #id_empleado_remi#
                        </isEqual>
                    </isNotEqual>
                </isNotNull>
                <isEqual prepend="" property="id_empleado_remi" compareValue="">
                    <isNotNull prepend="" property="id_empleado_dest">
                            <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                ad.id_empleado_dest = #id_empleado_dest#
                            </isNotEqual>
                    </isNotNull>
                </isEqual>

                <isNotNull prepend="" property="id_area_remi">
                    <isNotEqual prepend="AND" property="id_area_remi" compareValue="">
						(select erd.id_area from empleado erd where erd.id_empleado = ad.id_empleado_remi) = #id_area_remi#
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="nombre_remi">
                    <isNotEqual prepend="AND" property="nombre_remi" compareValue="">
						(select erd.nombre from empleado erd where erd.id_empleado = ad.id_empleado_remi) LIKE '%$nombre_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_remi">
                    <isNotEqual prepend="AND" property="paterno_remi" compareValue="">
						(select erd.paterno from empleado erd where erd.id_empleado = ad.id_empleado_remi) LIKE '%$paterno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_remi">
                    <isNotEqual prepend="AND" property="materno_remi" compareValue="">
						(select erd.materno from empleado erd where erd.id_empleado = ad.id_empleado_remi) LIKE '%$materno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="id_area_dest">
                    <isNotEqual prepend="AND" property="id_area_dest" compareValue="">
						(select erd.id_area from empleado erd where erd.id_empleado = ad.id_empleado_dest) = #id_area_dest#
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="nombre_dest">
                    <isNotEqual prepend="AND" property="nombre_dest" compareValue="">
						(select erd.nombre from empleado erd where erd.id_empleado = ad.id_empleado_dest) LIKE '%$nombre_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_dest">
                    <isNotEqual prepend="AND" property="paterno_dest" compareValue="">
						(select erd.paterno from empleado erd where erd.id_empleado = ad.id_empleado_dest) LIKE '%$paterno_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_dest">
                    <isNotEqual prepend="AND" property="materno_dest" compareValue="">
						(select erd.materno from empleado erd where erd.id_empleado = ad.id_empleado_dest) LIKE '%$materno_dest$%'
                    </isNotEqual>
                </isNotNull>
            </isEqual>

        </dynamic>
        
                        order by ad.fh_registro desc
			<!--
                            Orden que traia antes en las bandejas. Comentado por Rodolfo Milano.
                            Se solicito que se ordenara por la fecha de creacin del asunto
                            order by to_number(replace(substr(folio,instr(folio,'-',1,1)+1,instr(folio,'-',1,2)-instr(folio,'-',1,1)-1),'C','')) desc,
                                 to_number(replace(substr(folio,instr(folio,'-',1,2)+1),'C','')) desc,
                                 contador_folio desc -->
		) vista WHERE ROWNUM<![CDATA[ <= ]]>#paginador.maximo#
	    ) WHERE r<![CDATA[ >= ]]>#paginador.minimo#
    </select>

    <select id="countAsuntosInicialesNuevasReglas" parameterClass="mx.gob.economia.scg.model.CriterioAsunto" resultClass="java.lang.Integer">
         SELECT count(*) FROM
         (SELECT a.folio,
                a.id_asunto, a.asunto, a.descripcion, a.no_oficio, a.fh_oficio, a.fh_recepcion, a.id_empleado_capt,
                CASE to_number(to_char(ad.fh_limite-2,'d'))
                WHEN 7 THEN ad.fh_limite-4
                WHEN 6 THEN ad.fh_limite-4
                ELSE ad.fh_limite-2 END AS fh_por_vencer,

                <!-- Esta nueva opcin muestra las reglas de Estatus -->
               (SELECT ESTATUS_DET
                            FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                    FROM ASUNTO_DETALLE AD3
                                   WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#) OR
                                          AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                                          AD3.ID_EMPLEADO_REMI IN (SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                                          AD3.ID_EMPLEADO_DEST IN (SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#))
                                   GROUP BY AD3.ID_ASUNTO) AD_EST
                           WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) Max_estatus,
                CASE
                    <!-- ESTATUS ASUNTO = 0 AND ESTATUS ASUNTO_DETALLE = 2 THEN ESTATUS = 1 -->
                    WHEN (SELECT ESTATUS_DET
                    FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                    FROM ASUNTO_DETALLE AD3
                    WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#) OR
                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                    AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#))
                    GROUP BY AD3.ID_ASUNTO) AD_EST
                    WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0 AND A.ESTATUS =2 THEN 1

                    <!-- ESTATUS ASUNTO = 0 AND ESTATUS ASUNTO_DETALLE = 2 THEN ESTATUS = 1 -->
                    WHEN (SELECT ESTATUS_DET
                    FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                    FROM ASUNTO_DETALLE AD3
                    WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#) OR
                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                    AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#))
                    GROUP BY AD3.ID_ASUNTO) AD_EST
                    WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1 AND A.ESTATUS =2 THEN 1

                    <!-- SI NO APLICA EN LAS ANTERIORES UTILIZA ESTATUS ASUNTO -->
                ELSE A.ESTATUS
                END AS ESTATUS,

                <!-- ************************************************************************* -->

                c.correo AS correo_capt, c.nombre AS nombre_capt,
                c.paterno AS paterno_capt, c.materno AS materno_capt,
                c.id_area AS id_area_capt, ac.area AS area_capt, c.activo AS activo_capt, c.puesto AS puesto_capt,
                ad.id_asunto_detalle, ad.fh_lectura, ad.fh_registro, ad.fh_limite, ad.comentario, ad.ip,
                r.id_empleado AS id_empleado_remi, r.correo AS correo_remi, r.nombre AS nombre_remi,
                r.paterno AS paterno_remi, r.materno AS materno_remi,
                r.id_area AS id_area_remi, ar_r.area AS area_remi, r.activo AS activo_remi, r.puesto AS puesto_remi,
                d.id_empleado AS id_empleado_dest, d.correo AS correo_dest, d.nombre AS nombre_dest,
                d.paterno AS paterno_dest, d.materno AS materno_dest,
                d.id_area AS id_area_dest, ar_d.area AS area_dest, d.activo AS activo_dest, d.puesto AS puesto_dest,
                i.id_empleado AS id_empleado_ini, i.correo AS correo_ini, i.nombre AS nombre_ini,
                i.paterno AS paterno_ini, i.materno AS materno_ini,
                i.id_area AS id_area_ini, ar_i.area AS area_ini, i.activo AS activo_ini, i.puesto AS puesto_ini, a.id_asunto_padre,
                a.id_expediente, e.expediente, a.id_tema, t.id_tema_padre, t.tema, t.evento tema_evento, a.fh_evento,
                a.id_instruccion, ins.instruccion, a.id_tipo_asunto, ad.id_prioridad, a.antecedente, a.confidencial,
                a.folio || '-' || a.contador_folio contador_folio,
                (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) atencionParcial
            FROM asunto a,
               empleado c,
               empleado empleadoRemiAsunto,
               area areaRemiAsunto,
               empleado empleadoDestAsunto,
               area areaDestAsunto,
               area ac,
               asunto_detalle ad,
               empleado d,
               area ar_d,
               empleado r,
               area ar_r,
               empleado i,
               area ar_i,
               expediente e,
               tema t,
               instruccion ins
            where a.id_empleado_capt = c.id_empleado
            and a.ID_EMPLEADO_REMI = empleadoRemiAsunto.id_empleado
            and a.ID_EMPLEADO_DEST = empleadoDestAsunto.id_empleado
            and a.id_asunto = ad.id_asunto
            and a.id_expediente = e.id_expediente(+)
            and a.id_tema = t.id_tema(+)
            and a.id_instruccion = ins.id_instruccion
            and c.id_area = ac.id_area
            and empleadoRemiAsunto.id_area = areaRemiAsunto.id_area
            and empleadoDestAsunto.id_area = areaDestAsunto.id_area
            and ad.id_empleado_remi  = r.id_empleado
            and ad.id_empleado_dest  = d.id_empleado
            and ad.id_empleado_ini = i.id_empleado(+)
            and d.id_area  = ar_d.id_area
            and r.id_area = ar_r.id_area
            and i.id_area = ar_i.id_area(+)
        <dynamic prepend="">

            <isNotNull prepend="" property="estatus">
                <isNotEqual prepend="" property="estatus" compareValue="">
                    <isEqual prepend="AND" property="estatus" compareValue="0">
                        <isEqual prepend="" property="bandeja" compareValue="1">
                       (D.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_DEST)
                                                FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                               WHERE ID_AREA = #id_area_dest#
                                                 AND AD3.ID_EMPLEADO_DEST = D.ID_EMPLEADO) )
                        </isEqual>
                        <isEqual prepend="" property="bandeja" compareValue="2">
                       (R.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_REMI)
                                                 FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                                WHERE ID_AREA = #id_area_remi#
                                                  AND AD3.ID_EMPLEADO_REMI = R.ID_EMPLEADO))
                        </isEqual>
                       AND CASE
                            WHEN A.ESTATUS = 2 AND  (SELECT ESTATUS_DET
                                                       FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                               FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                            GROUP BY AD3.ID_ASUNTO) AD_EST
                                                      WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0
                            THEN 1
                            WHEN A.ESTATUS = 2 AND (SELECT ESTATUS_DET
                                                      FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                              FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                             GROUP BY AD3.ID_ASUNTO) AD_EST
                                                     WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1
                            THEN 1
                            ELSE A.ESTATUS
                       END = 0
                       AND AD.ID_ASUNTO_DETALLE IN (SELECT MAX
                                                      FROM (SELECT MAX(AD2.ID_ASUNTO_DETALLE) AS MAX, AD2.ID_ASUNTO
                                                              FROM ASUNTO_DETALLE AD2, ASUNTO A
                                                             WHERE AD2.ID_ASUNTO = A.ID_ASUNTO
                                                               AND AD2.ID_ASUNTO IN (SELECT AD3.ID_ASUNTO
                                                                                       FROM ASUNTO_DETALLE AD3
                                                                                        WHERE (
                                                                                    <isEqual prepend="" property="bandeja" compareValue="1">
                                                                                        AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                                                    </isEqual>
                                                                                    <isEqual prepend="" property="bandeja" compareValue="2">
                                                                                        AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                                                    </isEqual>
                                                                                        )
                                                                                    )
                                                             GROUP BY AD2.ID_ASUNTO
                                                            )
                                                    )
                       AND (SELECT COUNT(*)
                              FROM ASUNTO_ATENCION_PARCIAL AAP
                             WHERE AAP.ID_ASUNTO_DETALLE = AD.ID_ASUNTO_DETALLE)= 0
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="1">
                        <isEqual prepend="" property="bandeja" compareValue="1">
                       (D.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_DEST)
                                                FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                               WHERE ID_AREA = #id_area_dest#
                                                 AND AD3.ID_EMPLEADO_DEST = D.ID_EMPLEADO) )
                        </isEqual>
                        <isEqual prepend="" property="bandeja" compareValue="2">
                       (R.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_REMI)
                                                 FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                                WHERE ID_AREA = #id_area_remi#))
                        </isEqual>
                       AND CASE
                            WHEN A.ESTATUS = 2 AND  (SELECT ESTATUS_DET
                                                       FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                               FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                              GROUP BY AD3.ID_ASUNTO) AD_EST
                                                      WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0
                            THEN 1
                            WHEN A.ESTATUS = 2 AND (SELECT ESTATUS_DET
                                                      FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                              FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                             GROUP BY AD3.ID_ASUNTO) AD_EST
                                                     WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1
                            THEN 1
                            ELSE A.ESTATUS
                       END = 1
                       AND AD.ID_ASUNTO_DETALLE IN (SELECT MAX
                                                      FROM (SELECT MAX(AD2.ID_ASUNTO_DETALLE) AS MAX, AD2.ID_ASUNTO
                                                              FROM ASUNTO_DETALLE AD2, ASUNTO A
                                                             WHERE AD2.ID_ASUNTO = A.ID_ASUNTO
                                                               AND AD2.ID_ASUNTO IN (SELECT AD3.ID_ASUNTO
                                                               FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                                                    )
                                                             GROUP BY AD2.ID_ASUNTO
                                                            )
                                                    )
                        AND (SELECT COUNT(*)
                               FROM ASUNTO_ATENCION_PARCIAL AAP
                              WHERE AAP.ID_ASUNTO_DETALLE = AD.ID_ASUNTO_DETALLE)= 0
                        <isEqual prepend="" property="bandeja" compareValue="2">
                        AND (CASE
                                   WHEN (SELECT ESTATUS_DET
                                           FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                   FROM ASUNTO_DETALLE AD3
                                                    WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#) OR
                                                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                                                    AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                                                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#))
                                                  GROUP BY AD3.ID_ASUNTO) AD_EST
                                          WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0 AND A.ESTATUS =2 THEN 1
                                    WHEN (SELECT ESTATUS_DET
                                            FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                    FROM ASUNTO_DETALLE AD3
                                                    WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#) OR
                                                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                                                    AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#) OR
                                                    AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#))
                                                   GROUP BY AD3.ID_ASUNTO) AD_EST
                                           WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1 AND A.ESTATUS =2 THEN 1
                                    ELSE A.ESTATUS
                               END ) = 1
                        </isEqual>
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="2">
                        <isEqual prepend="" property="bandeja" compareValue="1">
                       (D.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_DEST)
                                                FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                               WHERE ID_AREA = #id_area_dest#
                                                 AND AD3.ID_EMPLEADO_DEST = D.ID_EMPLEADO) )
                        </isEqual>
                        <isEqual prepend="" property="bandeja" compareValue="2">
                       (R.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_REMI)
                                                 FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                                WHERE ID_AREA = #id_area_remi#
                                                  AND AD3.ID_EMPLEADO_REMI = R.ID_EMPLEADO))
                        </isEqual>
                        AND CASE
                                WHEN A.ESTATUS = 2 AND  (SELECT ESTATUS_DET
                                                           FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                                   FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                                  GROUP BY AD3.ID_ASUNTO) AD_EST
                                                          WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0
                                THEN 1
                                WHEN A.ESTATUS = 2 AND (SELECT ESTATUS_DET
                                                          FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                                  FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                                 GROUP BY AD3.ID_ASUNTO) AD_EST
                                                         WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1
                                THEN 1
                                ELSE A.ESTATUS
                        END = 2
                        AND AD.ID_ASUNTO_DETALLE IN (SELECT MAX
                                                       FROM (SELECT MAX(AD2.ID_ASUNTO_DETALLE) AS MAX, AD2.ID_ASUNTO
                                                               FROM ASUNTO_DETALLE AD2, ASUNTO A
                                                              WHERE AD2.ID_ASUNTO = A.ID_ASUNTO
                                                                AND AD2.ID_ASUNTO IN (SELECT AD3.ID_ASUNTO
                                                                                        FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                                                      )
                                                              GROUP BY AD2.ID_ASUNTO
                                                            )
                                                    )
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="3">
                        (D.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_DEST)
                                                 FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                                WHERE ID_AREA = #id_area_capt#
                                                  AND AD3.ID_EMPLEADO_DEST = D.ID_EMPLEADO)
                            OR R.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_REMI)
                                                   FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                                  WHERE ID_AREA = #id_area_capt#
                                                    AND AD3.ID_EMPLEADO_REMI = R.ID_EMPLEADO))
                        AND CASE
                                WHEN A.ESTATUS = 2 AND  (SELECT ESTATUS_DET
                                                           FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                                   FROM ASUNTO_DETALLE AD3
                                                                  WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_capt#) OR
                                                                         AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_capt# ))
                                                                  GROUP BY AD3.ID_ASUNTO) AD_EST
                                                          WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0
                                THEN 1
                                WHEN A.ESTATUS = 2 AND (SELECT ESTATUS_DET
                                                          FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                                  FROM ASUNTO_DETALLE AD3
                                                                  WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_capt#) OR
                                                                         AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_capt# ))
                                                                 GROUP BY AD3.ID_ASUNTO) AD_EST
                                                         WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1
                                THEN 1
                                ELSE A.ESTATUS
                        END = 3
                        AND AD.ID_ASUNTO_DETALLE IN (SELECT MAX
                                                       FROM (SELECT MAX(AD2.ID_ASUNTO_DETALLE) AS MAX, AD2.ID_ASUNTO
                                                               FROM ASUNTO_DETALLE AD2, ASUNTO A
                                                              WHERE AD2.ID_ASUNTO = A.ID_ASUNTO
                                                                AND AD2.ID_ASUNTO IN (SELECT AD3.ID_ASUNTO
                                                                                        FROM ASUNTO_DETALLE AD3
                                                                                      WHERE (AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_capt#) OR
                                                                                             AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_capt# ))
                                                                                     )
                                                              GROUP BY AD2.ID_ASUNTO
                                                            )
                                                    )
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="7">
                               a.estatus = #estatus#
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="14">
                        <isEqual prepend="" property="bandeja" compareValue="1">
                       (D.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_DEST)
                                                FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                               WHERE ID_AREA = #id_area_dest#
                                                 AND AD3.ID_EMPLEADO_DEST = D.ID_EMPLEADO) )
                        </isEqual>
                        <isEqual prepend="" property="bandeja" compareValue="2">
                       (R.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_REMI)
                                                 FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                                WHERE ID_AREA = #id_area_remi#
                                                  AND AD3.ID_EMPLEADO_REMI = R.ID_EMPLEADO))
                        </isEqual>
                        AND CASE
                                WHEN A.ESTATUS = 2 AND (SELECT ESTATUS_DET
                                                          FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                                  FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                                 GROUP BY AD3.ID_ASUNTO) AD_EST
                                                         WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0
                                THEN 1
                                WHEN A.ESTATUS = 2 AND (SELECT ESTATUS_DET
                                    FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                            FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                             GROUP BY AD3.ID_ASUNTO) AD_EST
                                   WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1
                                THEN 1
                                ELSE A.ESTATUS
                        END IN (0,1)
                        AND AD.ID_ASUNTO_DETALLE IN (SELECT MAX
                                                       FROM (SELECT MAX(AD2.ID_ASUNTO_DETALLE) AS MAX, AD2.ID_ASUNTO
                                                               FROM ASUNTO_DETALLE AD2, ASUNTO A
                                                              WHERE AD2.ID_ASUNTO = A.ID_ASUNTO
                                                                AND AD2.ID_ASUNTO IN (SELECT AD3.ID_ASUNTO
                                                                                        FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                                                     )
                                                              GROUP BY AD2.ID_ASUNTO
                                                            )
                                                    )
                        AND (SELECT COUNT(*)
                               FROM ASUNTO_ATENCION_PARCIAL AAP
                              WHERE AAP.ID_ASUNTO_DETALLE = AD.ID_ASUNTO_DETALLE)> 0
                    </isEqual>
                    <isEqual prepend="AND" property="estatus" compareValue="-1">
                        <isEqual prepend="" property="bandeja" compareValue="1">
                       (D.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_DEST)
                                                FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                               WHERE ID_AREA = #id_area_dest#
                                                 AND AD3.ID_EMPLEADO_DEST = D.ID_EMPLEADO) )
                        </isEqual>
                        <isEqual prepend="" property="bandeja" compareValue="2">
                       (R.ID_EMPLEADO IN (SELECT DISTINCT(ID_EMPLEADO_REMI)
                                                 FROM ASUNTO_DETALLE AD3, EMPLEADO D
                                                WHERE ID_AREA = #id_area_remi#
                                                  AND AD3.ID_EMPLEADO_REMI = R.ID_EMPLEADO))
                        </isEqual>
                       AND CASE
                            WHEN A.ESTATUS = 2 AND  (SELECT ESTATUS_DET
                                                       FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                               FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                              GROUP BY AD3.ID_ASUNTO) AD_EST
                                                      WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 0
                             THEN 1
                             WHEN A.ESTATUS = 2 AND (SELECT ESTATUS_DET
                                                       FROM (SELECT AD3.ID_ASUNTO, MAX(AD3.ESTATUS) AS ESTATUS_DET
                                                               FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                              GROUP BY AD3.ID_ASUNTO) AD_EST
                                                      WHERE AD_EST.ID_ASUNTO = AD.ID_ASUNTO) = 1
                            THEN 1
                            ELSE A.ESTATUS
                       END IN (0,1,2)
                       AND AD.ID_ASUNTO_DETALLE IN (SELECT MAX
                                                      FROM (SELECT MAX(AD2.ID_ASUNTO_DETALLE) AS MAX, AD2.ID_ASUNTO
                                                              FROM ASUNTO_DETALLE AD2, ASUNTO A
                                                             WHERE AD2.ID_ASUNTO = A.ID_ASUNTO
                                                               AND AD2.ID_ASUNTO IN (SELECT AD3.ID_ASUNTO
                                                                                       FROM ASUNTO_DETALLE AD3
                                                                WHERE (
                                                            <isEqual prepend="" property="bandeja" compareValue="1">
                                                                AD3.ID_EMPLEADO_DEST IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_dest#)
                                                            </isEqual>
                                                            <isEqual prepend="" property="bandeja" compareValue="2">
                                                                AD3.ID_EMPLEADO_REMI IN(SELECT ID_EMPLEADO FROM EMPLEADO WHERE ID_AREA = #id_area_remi#)
                                                            </isEqual>
                                                                )
                                                                                    )
                                                          GROUP BY AD2.ID_ASUNTO
                                                            )
                                                    )
                    </isEqual>
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="ids_asunto">
                <iterate prepend="AND" property="ids_asunto"
			open="(" close=")" conjunction="OR">
				a.id_asunto=#ids_asunto[]#
                </iterate>
            </isNotNull>
            <isNotNull prepend="" property="folio">
                <isNotEqual prepend="AND" property="folio" compareValue="">
						a.folio LIKE '$folio$'
                </isNotEqual>
            </isNotNull>

             <!--inicio AGG Filtro por referencia 20111107 -->
            <isNotNull prepend="" property="id_asunto_ref">
                <isNotEqual prepend="AND" property="id_asunto_ref" compareValue="">
						a.id_asunto_ref LIKE upper('%$id_asunto_ref$%')
                </isNotEqual>
            </isNotNull>
            <!--fin AGG Filtro por referencia 20111107 -->

            <isNotNull prepend="" property="id_asunto">
                <isNotEqual prepend="AND" property="id_asunto" compareValue="">
						a.id_asunto = #id_asunto#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="asunto">
                <isNotEqual prepend="AND" property="asunto" compareValue="">
						a.asunto LIKE '%$asunto$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="descripcion">
                <isNotEqual prepend="AND" property="descripcion" compareValue="">
						a.descripcion LIKE '%$descripcion$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="no_oficio">
                <isNotEqual prepend="AND" property="no_oficio" compareValue="">
						a.no_oficio LIKE '%$no_oficio$%'
                </isNotEqual>
            </isNotNull>

            <isNotNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio BETWEEN #fh_oficio_ini# AND #fh_oficio_fin#
                </isNotNull>
                <isNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio BETWEEN #fh_oficio_ini# AND SYSDATE
                </isNull>
            </isNotNull>
            <isNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio = #fh_oficio_fin#
                </isNotNull>
            </isNull>

            <isNull prepend="" property="fh_oficio_ini">
                <isNotNull prepend="AND" property="fh_oficio_fin">
					a.fh_oficio = #fh_oficio_fin#
                </isNotNull>
            </isNull>

            <isNotNull prepend="" property="fh_recepcion_ini">
                <isNotNull prepend="AND" property="fh_recepcion_fin">
		 				a.fh_recepcion BETWEEN #fh_recepcion_ini# AND #fh_recepcion_fin#
                </isNotNull>
            </isNotNull>

            <isNotNull prepend="" property="fh_lectura_ini">
                <isNotNull prepend="AND" property="fh_lectura_fin">
					ad.fh_lectura BETWEEN #fh_lectura_ini# AND #fh_lectura_fin#
                </isNotNull>
                <isNull prepend="AND" property="fh_lectura_fin">
					ad.fh_lectura BETWEEN #fh_lectura_ini# AND SYSDATE
                </isNull>
            </isNotNull>
            <isNull prepend="" property="fh_lectura_ini">
                <isNotNull prepend="AND" property="fh_lectura_fin">
					ad.fh_lectura = #fh_lectura_fin#
                </isNotNull>
            </isNull>

            <isNotNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
					ad.fh_registro BETWEEN #fh_registro_ini# AND #fh_registro_fin#
            </isNotNull>
                <isNull prepend="AND" property="fh_registro_fin">
					ad.fh_registro BETWEEN #fh_registro_ini# AND SYSDATE
                </isNull>
            </isNotNull>
            <isNull prepend="" property="fh_registro_ini">
                <isNotNull prepend="AND" property="fh_registro_fin">
					ad.fh_registro = #fh_registro_fin#
                </isNotNull>
            </isNull>

            <isNotNull prepend="" property="fh_limite_ini">
                <isNotNull prepend="AND" property="fh_limite_fin">
					ad.fh_limite BETWEEN #fh_limite_ini# AND #fh_limite_fin#
                </isNotNull>
            </isNotNull>
            <isNotNull prepend="AND" property="fh_limite_ini">
				ad.fh_limite = #fh_limite_ini#
            </isNotNull>
            <isNotNull prepend="" property="id_prioridad">
                <isGreaterThan prepend="AND" property="id_prioridad" compareValue="-1">
                    ad.id_prioridad = #id_prioridad#
                </isGreaterThan>
            </isNotNull>
            <isNotNull prepend="" property="id_tipo_documento">
                <isGreaterThan prepend="AND" property="id_tipo_documento" compareValue="-1">
                    a.id_tipo_asunto = #id_tipo_documento#
                </isGreaterThan>
            </isNotNull>
            <isNotNull prepend="" property="nombre_capt">
                <isNotEqual prepend="AND" property="nombre_capt" compareValue="">
						c.nombre LIKE '%$nombre_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="paterno_capt">
                <isNotEqual prepend="AND" property="paterno_capt" compareValue="">
						c.paterno LIKE '%$paterno_capt$%'
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="materno_capt">
                <isNotEqual prepend="AND" property="materno_capt" compareValue="">
						c.materno LIKE '%$materno_capt$%'
                </isNotEqual>
            </isNotNull><isNotNull prepend="" property="id_tema">
                <isNotEqual prepend="AND" property="id_tema" compareValue="-1">
						a.id_tema = #id_tema#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_expediente">
                <isNotEqual prepend="AND" property="id_expediente" compareValue="-1">
						a.id_expediente = #id_expediente#
                </isNotEqual>
            </isNotNull>
            <isNotNull prepend="" property="id_evento">
                <isNotEqual prepend="AND" property="id_evento" compareValue="-1">
						a.id_evento = #id_evento#
                </isNotEqual>
            </isNotNull>
            <!--
            <isNotNull prepend="" property="id_area_capt">
                <isNotEqual prepend="AND" property="id_area_capt" compareValue="">
                    (c.id_area = #id_area_capt#
                    or empleadoRemiAsunto.ID_AREA = #id_area_capt#
                    or empleadoDestAsunto.ID_AREA = #id_area_capt#)
                </isNotEqual>
            </isNotNull>
            -->
            <isNotNull prepend="" property="ids_empleados_ccp">
                <isNotEqual prepend="AND" property="ids_empleados_ccp" compareValue="">
                     (a.id_asunto in (select distinct id_asunto
                                      from asunto_detalle
                                      WHERE id_asunto_detalle IN (SELECT id_asunto_detalle
                                                                  FROM asunto_detalle_ccp
                                                                  WHERE id_empleado in ($ids_empleados_ccp$))
                                         or id_asunto_detalle IN (SELECT id_asunto_detalle
                                                                  FROM ASUNTO_ATT_PARC_CCP_CAPT
                                                                  WHERE id_empleado in ($ids_empleados_ccp$)))
                       or a.id_asunto in (SELECT id_asunto
                                          FROM asunto_ccp
                                          WHERE id_empleado in ($ids_empleados_ccp$)))
                </isNotEqual>
            </isNotNull>

            <isNotNull prepend="" property="confidencial">
                <isEqual prepend="AND" property="confidencial" compareValue="1" >
                                        a.confidencial = 1
                </isEqual>
                <isEqual prepend="AND" property="confidencial" compareValue="0" >
                                        a.confidencial = 0
                </isEqual>
            </isNotNull>
            <!--
            <isNotNull prepend="" property="enTramite">
                <isEqual prepend="AND" property="enTramite" compareValue="1" >
                            (a.estatus = 0 OR a.estatus = 1)
                            and (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) >0
                </isEqual>
                <isEqual prepend="AND" property="enTramite" compareValue="0" >
                                        (select count(*) from asunto_atencion_parcial aap where aap.id_asunto_detalle = ad.id_asunto_detalle) =0
                </isEqual>
            </isNotNull>
            -->
            <isEqual prepend="" property="busqueda_detalle" compareValue="0">
                <!-- and ad.id_asunto_detalle =  (select max(ID_ASUNTO_DETALLE) from asunto_detalle ad2 WHERE ad2.id_asunto = a.id_asunto) -->
                <isEqual prepend="AND" property="busqueda_modificado" compareValue="1">
                    a.estatus != 3
                    and a.id_asunto in (SELECT id_asunto
                                        FROM asunto_captura_actualizacion a
                                        WHERE a.estatus !=7
                                          and a.tipo_actualizacion = 0
                                          and id_empleado_dest = #id_empleado_dest#)
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="1">
                    ar_r.tipo = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="2">
                    ar_r.tipo = 1
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="1">
                    ar_d.tipo = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="2">
                    ar_d.tipo = 1
                </isEqual>

                <isNotNull prepend="" property="id_empleado_remi">
                    <isNotEqual prepend="AND" property="id_empleado_remi" compareValue="">
						a.id_empleado_remi = #id_empleado_remi#
                    </isNotEqual>
                </isNotNull>
                <!--
                <isNotNull prepend="" property="id_area_remi">
                    <isNotEqual prepend="AND" property="id_area_remi" compareValue="">
						r.id_area = #id_area_remi#
                    </isNotEqual>
                </isNotNull>
                -->
                <isNotNull prepend="" property="nombre_remi">
                    <isNotEqual prepend="AND" property="nombre_remi" compareValue="">
						r.nombre LIKE '%$nombre_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_remi">
                    <isNotEqual prepend="AND" property="paterno_remi" compareValue="">
						r.paterno LIKE '%$paterno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_remi">
                    <isNotEqual prepend="AND" property="materno_remi" compareValue="">
						r.materno LIKE '%$materno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isEqual prepend="" property="busqueda_modificado" compareValue="0">
                    <isNotNull prepend="" property="id_empleado_dest">
                        <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                                    a.id_empleado_dest = #id_empleado_dest#
                        </isNotEqual>
                    </isNotNull>
                </isEqual>
                <!--
                <isNotNull prepend="" property="id_area_dest">
                    <isNotEqual prepend="AND" property="id_area_dest" compareValue="">
						d.id_area = #id_area_dest#
                    </isNotEqual>
                </isNotNull>
                -->
                <isNotNull prepend="" property="nombre_dest">
                    <isNotEqual prepend="AND" property="nombre_dest" compareValue="">
						d.nombre LIKE '%$nombre_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_dest">
                    <isNotEqual prepend="AND" property="paterno_dest" compareValue="">
						d.paterno LIKE '%$paterno_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_dest">
                    <isNotEqual prepend="AND" property="materno_dest" compareValue="">
						d.materno LIKE '%$materno_dest$%'
                    </isNotEqual>
                </isNotNull>
                <!--
                <isNotEmpty prepend="" property="ids_estatus">
                    <iterate prepend="AND" property="ids_estatus"
                             open="(" close=")" conjunction="OR">
				   a.estatus =#ids_estatus[]#
                    </iterate>
                </isNotEmpty>
                -->
            </isEqual>
            <isEqual prepend="" property="busqueda_detalle" compareValue="1">
                <isEmpty prepend="" property="historico">
                    and ad.id_asunto_detalle =  (select max(ID_ASUNTO_DETALLE) from asunto_detalle ad2 WHERE ad2.id_asunto = a.id_asunto)
                </isEmpty>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="1">
                    (select a2.tipo from area a2 where a2.id_area =(select e2.id_area from empleado e2 where e2.id_empleado = ad.id_empleado_remi)) = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_remi" compareValue="2">
                    (select a2.tipo from area a2 where a2.id_area =(select e2.id_area from empleado e2 where e2.id_empleado = ad.id_empleado_remi)) = 1
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="1">
                    (select a3.tipo from area a3 where a3.id_area =(select e3.id_area from empleado e3 where e3.id_empleado = ad.id_empleado_dest)) = 0
                </isEqual>
                <isEqual prepend="AND" property="tipo_area_dest" compareValue="2">
                    (select a3.tipo from area a3 where a3.id_area =(select e3.id_area from empleado e3 where e3.id_empleado = ad.id_empleado_dest)) = 1
                </isEqual>
                <isNotEmpty prepend="" property="ids_estatus">
                    <iterate prepend="AND" property="ids_estatus"
                             open="(" close=")" conjunction="OR">
				   ad.estatus =#ids_estatus[]#
                    </iterate>
                </isNotEmpty>
		<isNotNull prepend="" property="id_empleado_recep">
                    <isNotEqual prepend="AND" property="id_empleado_recep" compareValue="">
                        (SELECT ar.id_empleado FROM asunto_recepcion ar where ar.id_asunto = ad.id_asunto and ar.id_asunto_detalle = ad.id_asunto_detalle and ar.id_empleado = #id_empleado_recep#) = #id_empleado_recep#
                    </isNotEqual>
		</isNotNull>

                <isNotNull prepend="" property="id_empleado_remi">
                    <isNotEqual prepend="" property="id_empleado_remi" compareValue="">
                        <isNotNull prepend="" property="id_empleado_dest">
                            <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                (ad.id_empleado_remi = #id_empleado_remi#
                                 or ad.id_empleado_dest = #id_empleado_dest#)
                            </isNotEqual>
                        </isNotNull>
                        <isEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                ad.id_empleado_remi = #id_empleado_remi#
                        </isEqual>
                    </isNotEqual>
                </isNotNull>
                <isEqual prepend="" property="id_empleado_remi" compareValue="">
                    <isNotNull prepend="" property="id_empleado_dest">
                            <isNotEqual prepend="AND" property="id_empleado_dest" compareValue="">
                                ad.id_empleado_dest = #id_empleado_dest#
                            </isNotEqual>
                    </isNotNull>
                </isEqual>

                <isNotNull prepend="" property="id_area_remi">
                    <isNotEqual prepend="AND" property="id_area_remi" compareValue="">
						(select erd.id_area from empleado erd where erd.id_empleado = ad.id_empleado_remi) = #id_area_remi#
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="nombre_remi">
                    <isNotEqual prepend="AND" property="nombre_remi" compareValue="">
						(select erd.nombre from empleado erd where erd.id_empleado = ad.id_empleado_remi) LIKE '%$nombre_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_remi">
                    <isNotEqual prepend="AND" property="paterno_remi" compareValue="">
						(select erd.paterno from empleado erd where erd.id_empleado = ad.id_empleado_remi) LIKE '%$paterno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_remi">
                    <isNotEqual prepend="AND" property="materno_remi" compareValue="">
						(select erd.materno from empleado erd where erd.id_empleado = ad.id_empleado_remi) LIKE '%$materno_remi$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="id_area_dest">
                    <isNotEqual prepend="AND" property="id_area_dest" compareValue="">
						(select erd.id_area from empleado erd where erd.id_empleado = ad.id_empleado_dest) = #id_area_dest#
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="nombre_dest">
                    <isNotEqual prepend="AND" property="nombre_dest" compareValue="">
						(select erd.nombre from empleado erd where erd.id_empleado = ad.id_empleado_dest) LIKE '%$nombre_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="paterno_dest">
                    <isNotEqual prepend="AND" property="paterno_dest" compareValue="">
						(select erd.paterno from empleado erd where erd.id_empleado = ad.id_empleado_dest) LIKE '%$paterno_dest$%'
                    </isNotEqual>
                </isNotNull>
                <isNotNull prepend="" property="materno_dest">
                    <isNotEqual prepend="AND" property="materno_dest" compareValue="">
						(select erd.materno from empleado erd where erd.id_empleado = ad.id_empleado_dest) LIKE '%$materno_dest$%'
                    </isNotEqual>
                </isNotNull>
            </isEqual>

        </dynamic>
        )
    </select>


</sqlMap>

